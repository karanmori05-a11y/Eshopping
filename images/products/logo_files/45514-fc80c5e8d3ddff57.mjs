(self.modernJsonp=self.modernJsonp||[]).push([["45514"],{17314:function(e,a,t){t.d(a,{Z:()=>d});var n,i,l=t(813653),r=t(831423),s=0,o=0;let d=function(e,a,t){var d=a&&t||0,u=a||Array(16),c=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:i;if(null==c||null==p){var g=e.random||(e.rng||l.Z)();null==c&&(c=n=[1|g[0],g[1],g[2],g[3],g[4],g[5]]),null==p&&(p=i=(g[6]<<8|g[7])&16383)}var m=void 0!==e.msecs?e.msecs:Date.now(),h=void 0!==e.nsecs?e.nsecs:o+1,y=m-s+(h-o)/1e4;if(y<0&&void 0===e.clockseq&&(p=p+1&16383),(y<0||m>s)&&void 0===e.nsecs&&(h=0),h>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,o=h,i=p;var f=((0xfffffff&(m+=122192928e5))*1e4+h)%0x100000000;u[d++]=f>>>24&255,u[d++]=f>>>16&255,u[d++]=f>>>8&255,u[d++]=255&f;var _=m/0x100000000*1e4&0xfffffff;u[d++]=_>>>8&255,u[d++]=255&_,u[d++]=_>>>24&15|16,u[d++]=_>>>16&255,u[d++]=p>>>8|128,u[d++]=255&p;for(var x=0;x<6;++x)u[d+x]=c[x];return a||(0,r.Z)(u)}},135885:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardAttribution_pin",selections:[{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[n,{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};i.hash="610a35d46510240eb58e262c1909310c";let l=i},5375:function(e,a,t){var n,i,l;t.r(a),t.d(a,{default:()=>s});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"BestPinCardBody_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},n={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[i={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[l={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{args:null,kind:"FragmentSpread",name:"RecipeMetadata_recipe"}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null}],storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},l,{args:null,kind:"FragmentSpread",name:"usePinImageUrls_pin"},{args:null,kind:"FragmentSpread",name:"useNormalizePinData_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardAttribution_pin"}],type:"Pin",abstractKey:null};r.hash="81db65fd15680cc0281b801ed4a8cb94";let s=r},500698:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"Descriptors_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null}],type:"Pin",abstractKey:null};n.hash="9d15639e8d9dd61426917dc218fbb3a6";let i=n},212480:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"OneBar_oneBarModules",selections:[{alias:"entityId",args:null,kind:"ScalarField",name:"id",storageKey:null},{args:null,kind:"FragmentSpread",name:"OneBarModule_oneBarModules"}],type:"OneBarModule",abstractKey:null};n.hash="45cea1099e24f55ebce4abebdb411447";let i=n},815025:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RecipeMetadata_recipe",selections:[{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:n,storageKey:null}],storageKey:null}],type:"RecipeMetadata",abstractKey:null};i.hash="12f77507a9fdec344b44b7e659fa5ac1";let l=i},984110:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsImageContent_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"}],type:"Pin",abstractKey:null};n.hash="727c8ab2c1c256e3b4478a36890f92d6";let i=n},55575:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n=(l=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],r=[{kind:"Variable",name:"pin",variableName:"pinId"}],s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o=[{kind:"Literal",name:"spec",value:"564x"}],p=[d={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},u={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],{fragment:{argumentDefinitions:l,kind:"Fragment",metadata:null,name:"RelatedProductsPageQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{args:null,kind:"FragmentSpread",name:"RelatedProductsPage_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"RelatedProductsPageQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[s,{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:o,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[d,u,c],storageKey:'images(spec:"564x")'},{alias:"imageSpec_564x",args:o,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:p,storageKey:'images(spec:"564x")'},{alias:"imageSpec_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:p,storageKey:'images(spec:"736x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:p,storageKey:'images(spec:"orig")'},{alias:"imageSpec_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:p,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:p,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"2b17eb88c62c11f3966426f1a462291f771985a456e2b017a676cd695dd749fa",metadata:{},name:"RelatedProductsPageQuery",operationKind:"query",text:null}});n.hash="0f7b98a1f02dbf8528df0452aa26efd4";let i=n;var l,r,s,o,d,u,c,p,g=n.default||n;if("query"===g.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(g);else{let e=[g.params.name,g.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=g}},376985:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsPage_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchPageWithPinData_pin"}],type:"Pin",abstractKey:null};n.hash="91d05676e413b7b47653c2f8fa609093";let i=n},758809:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"RelatedProductsUnifiedFeed_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchMasonryGrid_pin"}],type:"Pin",abstractKey:null};n.hash="20c2c7f4ff982fb93a9608faa14f3ed2";let i=n},584411:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthCropperContainer_pin",selections:[{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null}],storageKey:null},{args:null,kind:"FragmentSpread",name:"FlashlightSpotlightDots_pin"}],type:"Pin",abstractKey:null};n.hash="939d46d8644385a7918ed8179ce77a4c";let i=n},165135:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n=(l=[{defaultValue:null,kind:"LocalArgument",name:"pinId"}],r=[{kind:"Variable",name:"pin",variableName:"pinId"}],s={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},d={alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},u=[{kind:"Literal",name:"spec",value:"564x"}],m=[{kind:"Literal",name:"spec",value:"736x"}],h=[g={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},p={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},c={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],y=[{kind:"Literal",name:"spec",value:"474x"}],f=[{kind:"Literal",name:"spec",value:"236x"}],_={alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},x={alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},v=[{alias:null,args:null,kind:"ScalarField",name:"m",storageKey:null}],w={alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:S=[s],storageKey:null},k={alias:"image236x",args:f,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"236x")'},b={alias:"image474x",args:y,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"474x")'},P={alias:"image564x",args:u,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"564x")'},F={alias:"image736x",args:m,concreteType:"AdditionalImagesPerSpec",kind:"LinkedField",name:"additionalImagesPerSpec",plural:!0,selections:S,storageKey:'additionalImagesPerSpec(spec:"736x")'},C={alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null},R={alias:null,args:null,kind:"ScalarField",name:"fullName",storageKey:null},I={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},T={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},j=[p],{fragment:{argumentDefinitions:l,kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPageFetchData_pin"}],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:l,kind:"Operation",name:"UnauthDesktopFlashlightPageFetchDataPinQuery",selections:[{alias:null,args:r,concreteType:null,kind:"LinkedField",name:"v3GetPinQuery",plural:!1,selections:[s,{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Pin",kind:"LinkedField",name:"data",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},o,{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStela",storageKey:null},d],storageKey:null},{alias:"imageSpec_564x",args:u,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,g],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[c,p,g,s],storageKey:'images(spec:"orig")'},{alias:"imageSpec_736x",args:m,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"736x")'},{alias:"imageSpec_474x",args:y,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"474x")'},{alias:"imageSpec_236x",args:f,concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:h,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"lastRepinDate",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"createdAt",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"ArticleMetadata",kind:"LinkedField",name:"article",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"datePublished",storageKey:null}],storageKey:null},o,d,{alias:null,args:null,concreteType:"RecipeMetadata",kind:"LinkedField",name:"recipe",plural:!1,selections:[_,{alias:null,args:null,concreteType:"CategorizedIngredientsMetadata",kind:"LinkedField",name:"categorizedIngredients",plural:!0,selections:[x,{alias:null,args:null,concreteType:"ParsedIngredientMetadata",kind:"LinkedField",name:"ingredients",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"amt",storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"fromAggregatedData",storageKey:null},{alias:null,args:null,concreteType:"AggregateRatingMetadata",kind:"LinkedField",name:"aggregateRating",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"bestRating",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"ratingValue",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"reviewCount",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"CookTimes",kind:"LinkedField",name:"cookTimes",plural:!1,selections:[{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"cook",plural:!1,selections:v,storageKey:null},{alias:null,args:null,concreteType:"CookTime",kind:"LinkedField",name:"prep",plural:!1,selections:v,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[s,_,w,{alias:null,args:null,concreteType:"Brand",kind:"LinkedField",name:"brand",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"signature",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ShippingInfo",kind:"LinkedField",name:"shippingInfo",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"freeShippingPrice",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"freeShippingValue",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariantSet",kind:"LinkedField",name:"variantSet",plural:!1,selections:[{alias:null,args:null,concreteType:"DimensionMetadata",kind:"LinkedField",name:"dimensionMetadata",plural:!0,selections:[_,{alias:null,args:null,kind:"ScalarField",name:"values",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"ProductVariant",kind:"LinkedField",name:"variants",plural:!0,selections:S,storageKey:null}],storageKey:null},k,b,P,F],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[_,w,{alias:null,args:null,kind:"ScalarField",name:"itemId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"itemSetId",storageKey:null},k,b,P,F],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"nativeCreator",plural:!1,selections:[C,R,I],storageKey:null},d,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyPinDataId",storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"StoryPinMetadataField",kind:"LinkedField",name:"metadata",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"pinTitle",storageKey:null}],storageKey:null},I,s],storageKey:null},{alias:null,args:null,concreteType:"PinJoin",kind:"LinkedField",name:"pinJoin",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"visualAnnotation",storageKey:null}],storageKey:null},T,{alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null}],storageKey:null},x,{alias:"imageSpec_60x60",args:[{kind:"Literal",name:"spec",value:"60x60"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"60x60")'},{alias:"imageSpec_136x136",args:[{kind:"Literal",name:"spec",value:"136x136"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"136x136")'},{alias:"imageSpec_170x",args:[{kind:"Literal",name:"spec",value:"170x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"170x")'},{alias:"imageSpec_600x315",args:[{kind:"Literal",name:"spec",value:"600x315"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:j,storageKey:'images(spec:"600x315")'},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null},{alias:null,args:null,concreteType:"Board",kind:"LinkedField",name:"board",plural:!1,selections:[T,_,{alias:null,args:null,kind:"ScalarField",name:"privacy",storageKey:null},p,I],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:[T,R,{alias:null,args:null,kind:"ScalarField",name:"imageMediumUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSmallUrl",storageKey:null},C,I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isOosProduct",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isStaleProduct",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:S,storageKey:null},I],storageKey:null},{alias:null,args:null,concreteType:"ProductMetadataV2",kind:"LinkedField",name:"productPinData",plural:!1,selections:[{alias:null,args:null,concreteType:"ItemMetadata",kind:"LinkedField",name:"items",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"additionalImagesLength",storageKey:null}],storageKey:null},I],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"shoppingFlags",storageKey:null},{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"isShopTheLook",storageKey:null},I],storageKey:null},I],storageKey:null}],type:"V3GetPin",abstractKey:null}],storageKey:null}]},params:{id:"4f98fda893ba1980532b9905b28f196e419e75b106a6485f5f63653917b888e1",metadata:{},name:"UnauthDesktopFlashlightPageFetchDataPinQuery",operationKind:"query",text:null}});n.hash="c1c702b23a1454b46f8e2fa9d8036257";let i=n;var l,r,s,o,d,u,c,p,g,m,h,y,f,_,x,v,S,w,k,b,P,F,C,R,I,T,j,E=n.default||n;if("query"===E.params.operationKind)if(window.__pwsCacheRelayConcreteRequest)window.__pwsCacheRelayConcreteRequest(E);else{let e=[E.params.name,E.params.id].join(":");window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__=window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__||{},window.__PWS_RELAY_CONCRETE_REQUEST_CACHE__[e]=E}},514336:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPageFetchData_pin",selections:[{args:null,kind:"FragmentSpread",name:"UnauthDesktopFlashlightPage_pin"}],type:"Pin",abstractKey:null};n.hash="01839fc3bcd9cdaf206873364167d157";let i=n},579652:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"UnauthDesktopFlashlightPage_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,concreteType:"StelaVisualObject",kind:"LinkedField",name:"visualObjects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"x",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"y",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"w",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"h",storageKey:null}],storageKey:null},{alias:"imageSpec_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n=[{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:n,storageKey:'images(spec:"orig")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"BestPinCardBody_pin"},{args:null,kind:"FragmentSpread",name:"UnauthCropperContainer_pin"}],type:"Pin",abstractKey:null};i.hash="93612431e09eadc717c32d98e8d91e06";let l=i},172359:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCarousel_story",selections:[{alias:null,args:null,concreteType:"StoryAction",kind:"LinkedField",name:"action",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"contentIds",storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"objects",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null},{alias:"storyId",args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"storyType",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackingParams",storageKey:null},{args:null,kind:"FragmentSpread",name:"CSSCarouselModule_story"}],type:"Story",abstractKey:null};n.hash="b1061aefab46af37d4c9716916386af2";let i=n},829187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsImageContent_pin"},{args:null,kind:"FragmentSpread",name:"RelatedProductsUnifiedFeed_pin"}],type:"Pin",abstractKey:null};n.hash="3a9a747c3135f426fe0cf32ca9147a5d";let i=n},934209:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchCropper_pin",selections:[{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"useSamSegmentation_pin"}],type:"Pin",abstractKey:null};n.hash="fbf2d3b93402a9dd783073db316c0f92";let i=n},922081:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchImageContainer_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"dominantColor",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"VisualSearchCropper_pin"},{args:null,kind:"FragmentSpread",name:"Descriptors_pin"}],type:"Pin",abstractKey:null};n.hash="8250aa2ed9c603023c2f2a226d0b9fbb";let i=n},331921:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchLayout_pin",selections:[{args:null,kind:"FragmentSpread",name:"VisualSearchImageContainer_pin"}],type:"Pin",abstractKey:null};n.hash="3c3f391c3bf9eec79c18ed9a3fe63800";let i=n},553593:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualSearchPageWithPinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageSignature",storageKey:null},{alias:"image",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{args:null,kind:"FragmentSpread",name:"useGetNormalizedPinImage_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchContainer_pin"},{args:null,kind:"FragmentSpread",name:"VisualSearchLayout_pin"}],type:"Pin",abstractKey:null};n.hash="ece11b62e2de551b92d24a2389316249";let i=n},799956:function(e,a,t){var n;t.r(a),t.d(a,{default:()=>l});let i={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useNormalizePinData_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedDescription",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"category",storageKey:null},{alias:"imageSpec_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:n=[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:n,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null};i.hash="01a93671cde480baa2cfd8b781589acd";let l=i},160187:function(e,a,t){t.r(a),t.d(a,{default:()=>i});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useSamSegmentation_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"Pin",abstractKey:null};n.hash="50c726067ab8af873ed4afded90b7bed";let i=n},742235:function(e,a,t){t.r(a),t.d(a,{default:()=>v});var n,i=t(281098),l=t(667294),r=t(167912),s=t(825332),o=t(20256),d=t(618140),u=t(29313),c=t(748130),p=t(289032),g=t(19585),m=t(816358),h=t(809295),y=t(15667),f=t(271910),_=t(785893);let x=(void 0!==n||(n=t(212480)).hash&&"45cea1099e24f55ebce4abebdb411447"!==n.hash&&console.error("The definition of 'OneBar_oneBarModules' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function v({center:e=!1,hasProductFiltersApplied:a,hrefOverride:t,itemHeight:n=d.Lu,marginBottom:v=d.JC,oneBarModulesKey:S,oneBarModulesRest:w,onFilterButtonClick:k,paddingBottom:b=d.uS,paddingX:P=d.jf,variant:F,viewParameter:C,viewType:R}){(0,l.useEffect)(()=>{(0,i.Z)("OneBar","/app/common/react/components/OneBar/OneBar.tsx")},[]);let I=(0,l.useRef)(null),T=I.current?.firstElementChild?.firstElementChild?.firstElementChild,[j,E]=(0,l.useState)(0),[Z,D]=(0,l.useState)(0),[M,K]=(0,l.useState)(!1),[L,A]=(0,l.useState)(!1),[$,O]=(0,l.useState)(0),B=(0,s.TH)(),N=(0,g.ZP)(),{isRTL:z}=(0,y.B)(),U=(0,l.useRef)(!1),W=new h.ZP,H=(0,r.useFragment)(x,S),V=H&&[H]||w,G=e&&(T?.clientWidth||0)>=(T?.scrollWidth||0);(0,l.useEffect)(()=>{let e=e=>{"Tab"===e.key&&(U.current=!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[]),(0,l.useEffect)(()=>{E(0)},[B]),(0,l.useEffect)(()=>{D(T?.clientWidth||0);let e=(0,p.Z)(()=>{D(T?.clientWidth||0)},100,{maxWait:200});return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[T]),(0,l.useEffect)(()=>{let e=I.current;return e&&m.Z.addObstruction("top",e),()=>{e&&m.Z.removeObstruction("top",e)}}),(0,l.useEffect)(()=>{let e=T?.scrollWidth||0,a=0;for(let e=0;e<j;e+=1)a+=T?.children[e]?.offsetWidth||0;let t=e-a,n=Z>=e;n&&E(0),K(j>0&&!n),A(t>Z&&j<V.length&&!n),O(a)},[T,j,V.length,Z,$,z]);let Y=()=>{j+3<V.length?E(j+3):E(V.length-1)},X=()=>{j-3>=0?E(j-3):E(0)},q=(0,l.useRef)(null),{isFiltersDrawerFocused:Q}=(0,u.e)()||{isFiltersDrawerFocused:!1},[J,ee]=(0,l.useState)(Q);return(0,l.useEffect)(()=>{!Q&&J&&q.current?.focus(),ee(Q)},[Q,J]),V.length>0&&(0,_.jsx)(f.q,{children:({hovered:e,onMouseEnter:i,onMouseLeave:l})=>(0,_.jsxs)(o.xu,{ref:I,color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:b}},"data-root-margin":"search-one-bar","data-test-id":"scrollable-one-bar-root",marginBottom:v,onMouseEnter:i,onMouseLeave:l,position:"relative",children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{overflowX:"clip"}},paddingX:P,position:"relative",children:(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{[z?"right":"left"]:`-${$}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,_.jsx)(o.kC,{alignItems:"center",gap:{row:2,column:0},height:n,justifyContent:G?"center":void 0,children:V.map((e,n)=>(0,_.jsx)(o.xu,{ref:1===n?q:void 0,onFocus:()=>{U.current||E(n)},onMouseDown:()=>U.current=!0,tabIndex:1===n?-1:void 0,children:(0,_.jsx)(c.Z,{hasProductFiltersApplied:a,hrefOverride:t,impressionsFramework:W,index:n,module:e,oneBarModulesKey:H??null,onFilterButtonClick:k,variant:F,viewParameter:C,viewType:R})},`OneBarModule-${e.entityId||e.id||""}`))})})}),e&&(0,_.jsxs)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{background:(0,d.KC)(z,M,L),paddingBottom:d.uS,paddingLeft:d.EA,paddingRight:d.EA,pointerEvents:"none"}},"data-test-id":"one-bar-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:M&&(0,_.jsx)(o.hU,{accessibilityLabel:N._('Back', 'oneBar.navArrow.back', 'Accessibility laber for a button that navigates back to previous search guides'),bgColor:"white",icon:"arrow-back",onClick:X})}),(0,_.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},children:L&&(0,_.jsx)(o.hU,{accessibilityLabel:N._('Forward', 'oneBar.navArrow.forward', 'Accessibility laber for a button that navigates forward to see more search guides'),bgColor:"white",icon:"arrow-forward",onClick:Y})})]})]})})}},699473:function(e,a,t){t.d(a,{Z:()=>l});var n=t(450808);let i=`pulsing {
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
}`,l={css:(0,n.Ll)([i]),animation:"pulsing 2s infinite"}},937805:function(e,a,t){t.d(a,{Z:()=>r});var n=t(675973),i=t(15667),l=t(647709);function r(){let{isAuthenticated:e}=(0,i.B)(),a=(0,l.ml)(),{checkExperiment:t}=(0,n.Z)();return{mWebCloseupRedesignEnabled:e&&a&&t("mweb_closeup_redesign").anyEnabled,mWebCloseupRedesignExpGroup:t("mweb_closeup_redesign").group}}},241646:function(e,a,t){t.d(a,{n:()=>n});let n=20},583270:function(e,a,t){t.d(a,{Z:()=>i});var n=t(378888);function i(e,a,t){let i=(0,n.mB)(e.search),l=parseFloat(i.x??""),r=parseFloat(i.y??""),s=parseFloat(i.w??""),o=parseFloat(i.h??"");if(function(...e){return e.every(e=>e>=0&&e<=1)}(l,r,s,o)&&a&&t)return{x:Math.floor(l*a),y:Math.floor(r*t),w:Math.floor(s*a),h:Math.floor(o*t)};{let e=parseInt(i.x??"",10),a=parseInt(i.y??"",10),t=parseInt(i.w??"",10),n=parseInt(i.h??"",10);return!function(...e){return e.every(Number.isInteger)}(e,a,t,n)?null:{x:e,y:a,w:t,h:n}}}},351222:function(e,a,t){t.d(a,{Pw:()=>n,SB:()=>i,ZP:()=>r,x9:()=>l});let n=80,i=55,l=e=>"phone"===e?i:n;function r(e,a){return a?0:l(e)}},166379:function(e,a,t){t.d(a,{Z:()=>l,k:()=>n.kH});var n=t(654937),i=t(15667);let l=({dateFormatType:e,useUTC:a=!0,value:t})=>{let l=(0,i.B)();return(0,n.ZP)(l.locale,t,e,a)}},469167:function(e,a,t){t.r(a),t.d(a,{default:()=>j});var n=t(281098),i=t(667294),l=t(20256),r=t(748065),s=t(980787),o=t(722194);function d(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let u={},c=e=>{let a=e.__id||e.id;return"string"==typeof a&&a||null};class p{constructor(){d(this,"idMap",new Map),d(this,"objMap",new WeakMap)}get(e){let a=c(e);return this.objMap.get(e)??(a?this.idMap.get(a):void 0)}has(e){let a=c(e);return this.objMap.has(e)??(!!a&&this.idMap.has(a))}set(e,a){let t=c(e);t&&this.idMap.set(t,a),this.objMap.set(e,a)}reset(){this.idMap=new Map,this.objMap=new WeakMap}}function g(e,a){return"number"==typeof e?e:"lg1"===a?e[a]??e.lg??1:e[a]??1}var m=t(467925),h=t(947543),y=t(699473),f=t(461951),_=t(369416),x=t(785893);let{css:v,animation:S}=y.Z,w={backgroundColor:f.zsO,animation:S,borderRadius:f.saV};function k({data:e}){(0,i.useEffect)(()=>{(0,n.Z)("SkeletonPin","/app/common/react/components/SkeletonLoadingStates/SkeletonPin.tsx")},[]);let{height:a}=e;return(0,x.jsxs)(i.Fragment,{children:[(0,x.jsx)(_.Z,{unsafeCSS:v}),(0,x.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:w},"data-test-id":"skeleton-pin",children:(0,x.jsx)(l.xu,{height:a})})]})}var b=t(93966),P=t(675973),F=t(15667),C=t(647709),R=t(603316),I=t(160374),T=t(183152);function j(e){(0,i.useEffect)(()=>{(0,n.Z)("Masonry","/app/packages/gestaltExtensions/Masonry/Masonry.tsx")},[]);let{align:a,cacheKey:t,id:d,isFetching:c,isGridCentered:y=!0,items:f,layout:v,loadItems:S,masonryRef:w,optOutFluidGridExperiment:j=!1,renderItem:E,scrollContainerRef:Z,virtualize:D=!0,getColumnSpanConfig:M,_getResponsiveModuleConfigForSecondItem:K,isLoadingStateEnabled:L,initialLoadingStatePinCount:A,isLoadingAccessibilityLabel:$,isLoadedAccessibilityLabel:O}=e,B=(0,C.ZP)(),N=(0,F.B)(),{isAuthenticated:z,isRTL:U}=N,{logContextEvent:W}=(0,s.u)(),H=(0,P.Z)(),V="desktop"===B,G=(0,T.Zv)(),Y=(0,I.DB)(),X=((0,i.useRef)(f.map(()=>({fetchTimestamp:Date.now(),measureTimestamp:Date.now(),hasRendered:!1,pageCount:0}))),V&&!j),{experimentalColumnWidth:q,experimentalGutter:Q}=(0,m.Z)(X),J=e.serverRender??!!V,ee="flexible"===v||"uniformRowFlexible"===v||"desktop"!==B||X,ea=(ee&&v?.startsWith("uniformRow")?"uniformRowFlexible":void 0)??(J?"serverRenderedFlexible":"flexible"),et=e.columnWidth??q??b.yF;ee&&(et=Math.floor(et));let en=e.gutterWidth??Q??(V?b.oX:1),ei=e.minCols??b.yc,el=((0,i.useRef)(0),et+en),er=function(e){if(null==e)return;let a=function(e){let a=u[e];return a&&a.screenWidth===window.innerWidth||(u[e]={screenWidth:window.innerWidth}),u[e]}(e);return a.measurementCache||(a.measurementCache=new p),a.measurementCache}(t),es=(0,i.useCallback)(()=>Z?.current||window,[Z]),eo=(0,i.useRef)(!0),{anyEnabled:ed}=H.checkExperiment("web_masonry_pin_overlap_calculation_and_logging"),{anyEnabled:eu,group:ec}=H.checkExperiment("web_masonry_fluid_reflow"),{anyEnabled:ep}=H.checkExperiment("visual_search_stl_eligibility_check_migration_gss_css",{dangerouslySkipActivation:!0}),eg=y&&eo.current?"centered":"",{className:em,styles:eh}=function(e){let a=`m_${Object.keys(e).sort().reduce((a,t)=>{let n=e[t];return null==n||"object"==typeof n||"function"==typeof n?a:"boolean"==typeof n?a+(n?"t":"f"):a+n},"").replace(/\:/g,"\\:")}`,{flexible:t,gutterWidth:n,isRTL:i,itemWidth:l,maxColumns:r,minColumns:s,items:o,getColumnSpanConfig:d,_getResponsiveModuleConfigForSecondItem:u}=e,c=d?o.map((e,a)=>({index:a,columnSpanConfig:d(e)??1})).filter(e=>1!==e.columnSpanConfig):[],p=l+n,m=Array.from({length:r+1-s},(e,a)=>a+s).map(e=>{let m,h,y=e===s?0:e*p,f=e===r?null:(e+1)*p-.01;d&&u&&o.length>1&&(m=d(o[0]),h=u(o[1]));let{styles:_,numberOfVisibleItems:x}=c.reduce((i,r)=>{let{columnSpanConfig:s}=r,d=Math.min(function({columnCount:e,columnSpanConfig:a,firstItemColumnSpanConfig:t,isFlexibleWidthItem:n,secondItemResponsiveModuleConfig:i}){let l=e<=2?"sm":e<=4?"md":e<=6?"lg1":e<=8?"lg":"xl",r=g(a,l);if(n){let a=g(t,l);r="number"==typeof i?i:i?Math.max(i.min,Math.min(i.max,e-a)):1}return r}({columnCount:e,columnSpanConfig:s,isFlexibleWidthItem:!!h&&r===o[1],firstItemColumnSpanConfig:m??1,secondItemResponsiveModuleConfig:h??1}),e),u=null!=r.index&&i.numberOfVisibleItems>=d+r.index,c=t?100/e*d:l*d+n*(d-1),{numberOfVisibleItems:p}=i;return u?p-=d-1:r.index<p&&(p+=1),{styles:i.styles.concat(function({className:e,index:a,columnSpanConfig:t,visible:n,width:i,flexible:l}){let r="number"==typeof t?t:btoa(JSON.stringify(t));return l?`
      .${e} .static[data-column-span="${r}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}% !important;
      }`:`
      .${e} .static[data-column-span="${r}"]:nth-child(${a+1}) {
        visibility: ${n?"visible":"hidden"} !important;
        position: ${n?"inherit":"absolute"} !important;
        width: ${i}px !important;
      }`}({className:a,index:r.index,columnSpanConfig:s,visible:u,width:c,flexible:t})),numberOfVisibleItems:p}},{styles:"",numberOfVisibleItems:e}),v=t?`
      .${a} .static {
        box-sizing: border-box;
        width: calc(100% / ${e}) !important;
      }
    `:`
      .${a} {
        max-width: ${e*p}px;
      }

      .${a} .static {
        width: ${l}px !important;
      }
    `;return{minWidth:y,maxWidth:f,styles:`
      .${a} .static:nth-child(-n+${x}) {
        position: static !important;
        visibility: visible !important;
        float: ${i?"right":"left"};
        display: block;
      }

      .${a} .static {
        padding: 0 ${n/2}px;
      }

      ${v}

      ${_}
    `}}),h=m.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @container (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),y=m.map(({minWidth:e,maxWidth:a,styles:t})=>`
    @media (min-width: ${e}px) ${a?`and (max-width: ${a}px)`:""} {
      ${t}
    }
  `),f=`
    ${h.join("")}
    @supports not (container-type: inline-size) {
      ${y.join("")}
    }
  `;return{className:a,styles:`
    .masonryContainer:has(.${a}) {
      container-type: inline-size;
    }

    .masonryContainer > .centered {
      margin-left: auto;
      margin-right: auto;
    }

    .${a} .static {
      position: absolute !important;
      visibility: hidden !important;
    }

    ${f}
  `}}({gutterWidth:en,flexible:ee,items:f,isRTL:U,itemWidth:et,maxColumns:e.maxColumns??Math.max(f.length,b.g5),minColumns:ei,getColumnSpanConfig:M,_getResponsiveModuleConfigForSecondItem:K}),ey=`${eg} ${em}`.trim(),{anyEnabled:ef,expName:e_,group:ex,isMeasureAllEnabled:ev}=(0,h.Z)(),eS=((0,i.useRef)(void 0),(0,i.useRef)(f.length)),ew=(0,i.useRef)(0),ek=(0,i.useRef)(null);(0,i.useEffect)(()=>{eS.current=f.length,ew.current+=1},[f]),(0,i.useEffect)(()=>{if(eo.current&&(eo.current=!1),window.earlyGridRenderStats){let e={...(0,I.M3)({earlyHydrationConfig:Y,handlerId:G,requestContext:N}),status:window.earlyGridRenderStats.status??"unknown"};(0,R.nP)(`earlyHydrationDebug.masonry.earlyGridRender.status.${window.earlyGridRenderStats.status}`,{tags:e}),(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.init",window.earlyGridRenderStats.init,{tags:e}),window.earlyGridRenderStats.start&&(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.start",window.earlyGridRenderStats.start,{tags:e}),window.earlyGridRenderStats.end&&(0,R.LY)("earlyHydrationDebug.masonry.earlyGridRender.end",window.earlyGridRenderStats.end,{tags:e})}},[]),(0,i.useEffect)(()=>()=>{},[]);let eb=(0,i.useCallback)(e=>{let a=e.reduce((e,a)=>e+a),t=a/e.length;(0,R.nP)("webapp.masonry.multiColumnWhitespace.count",{sampleRate:1,tags:{fluidResizeExperiment:ec||"unknown",experimentalMasonryGroup:ex||"unknown",handlerId:G,isAuthenticated:z,multiColumnItemSpan:e.length}}),(0,R.S0)("webapp.masonry.multiColumnWhitespace.average",t,{sampleRate:1,tags:{columnWidth:et,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:G,isAuthenticated:z,minCols:ei,multiColumnItemSpan:e.length}}),W({event_type:15878,component:14468,aux_data:{total_whitespace_px:a}}),W({event_type:16062,component:14468,aux_data:{average_whitespace_px:t}}),W({event_type:16063,component:14468,aux_data:{max_whitespace_px:Math.max(...e)}}),e.forEach(a=>{a>=50&&((0,R.nP)("webapp.masonry.multiColumnWhitespace.over50",{sampleRate:1,tags:{experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:G,isAuthenticated:z,multiColumnItemSpan:e.length}}),W({event_type:16261,component:14468})),a>=100&&((0,R.nP)("webapp.masonry.multiColumnWhitespace.over100",{sampleRate:1,tags:{experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",handlerId:G,isAuthenticated:z,multiColumnItemSpan:e.length}}),W({event_type:16262,component:14468}))})},[et,ex,ec,G,z,W,ei]),{_items:eP,_renderItem:eF}=function({initialLoadingStatePinCount:e=50,infiniteScrollPinCount:a=10,isFetching:t,items:n=[],renderItem:l,isLoadingStateEnabled:r}){let s=+(n.filter(e=>"object"==typeof e&&null!==e&&"type"in e&&"closeup_module"===e.type).length>0),o=r&&t,d=(0,i.useMemo)(()=>Array.from({length:n.length>s?a:e}).reduce((e,a,t)=>[...e,{height:t%2==0?356:236,key:`skeleton-pin-${t}`,isSkeleton:!0}],[]),[n.length,s,a,e]);return{_items:(0,i.useMemo)(()=>o?[...n,...d]:n,[o,n,d]),_renderItem:(0,i.useMemo)(()=>r?e=>{let{itemIdx:a,data:t}=e;return a>=n.length&&t&&"object"==typeof t&&"key"in t&&"height"in t?(0,x.jsx)(k,{data:t},t.key):l(e)}:l,[r,l,n.length])}}({isLoadingStateEnabled:L,items:f,renderItem:(0,i.useCallback)(e=>(0,x.jsx)(o.Z,{name:"MasonryItem",children:E(e)}),[E]),isFetching:c,initialLoadingStatePinCount:A}),eC=L&&c,eR=(0,i.useRef)(new Set);(0,i.useEffect)(()=>{if(!ed)return;let e=setTimeout(()=>{requestAnimationFrame(()=>{let e=Array.from(ek.current?.querySelectorAll("[data-grid-item-idx]")??[]);if(0===e.length)return;let a=e.map(e=>{let a=e.getAttribute("data-grid-item-idx");return{rect:e.getBoundingClientRect(),itemIdx:a}}),t=0,n=0,i=0,l=0,r=0,s=0;for(let e=0;e<a.length;e+=1){let o=a[e]?.rect,d=a[e]?.itemIdx;for(let u=e+1;u<a.length;u+=1){let e=a[u]?.rect,c=a[u]?.itemIdx;if(o&&e&&d&&c){let a=[d,c].sort().join("|");if(!eR.current.has(a)&&o.right>=e.left&&o.left<=e.right&&o.bottom>=e.top&&o.top<=e.bottom&&o.height>0&&e.height>0){eR.current.add(a),t+=1;let d=Math.max(0,Math.min(o.right,e.right)-Math.max(o.left,e.left))*Math.max(0,Math.min(o.bottom,e.bottom)-Math.max(o.top,e.top));d>8e4?s+=1:d>4e4?r+=1:d>1e4?l+=1:d>5e3?i+=1:d>2500&&(n+=1)}}}}t>0&&(0,R.QX)("webapp.masonry.pinOverlapHits",t,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),n>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over2500",n,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),i>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over5000",i,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),l>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over10000",l,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),r>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over40000",r,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}}),s>0&&(0,R.QX)("webapp.masonry.pinOverlap.AreaPx.over80000",s,{tags:{isAuthenticated:z,isDesktop:V,handlerId:G,experimentalMasonryGroup:ex||"unknown",fluidResizeExperiment:ec||"unknown",visualSearchSTLexperiment:ep?"true":"false"}})})},1e3);return()=>{clearTimeout(e)}},[et,ex,ec,z,V,ed,f,G,ep]);let eI=(0,r.Z)(),eT=(0,i.useCallback)(e=>{w&&(w.current=e)},[w]);return(0,x.jsxs)(i.Fragment,{children:[L&&!eo.current&&(0,x.jsx)(l.xu,{"aria-live":"polite",display:"visuallyHidden",children:eC?$:O}),(0,x.jsx)("div",{ref:ek,"aria-busy":L?!!eC:void 0,className:"masonryContainer","data-test-id":"masonry-container",id:d,style:X?{padding:`0 ${en/2}px`}:void 0,children:(0,x.jsxs)("div",{className:ey,children:[J&&eo.current?(0,x.jsx)(_.Z,{"data-test-id":"masonry-ssr-styles",unsafeCSS:eh}):null,(0,x.jsx)(l.xu,{"data-test-id":"max-width-container",marginBottom:0,marginEnd:"auto",marginStart:"auto",marginTop:0,maxWidth:e.maxColumns?el*e.maxColumns:void 0,children:ef?(0,x.jsx)(l.GX,{ref:eI?eT:e=>{w&&(w.current=e)},_dynamicHeights:!0,_getResponsiveModuleConfigForSecondItem:K,_logTwoColWhitespace:eb,_measureAll:ev,align:a,columnWidth:et,getColumnSpanConfig:M,gutterWidth:en,items:eP,layout:ee?ea:v??"basic",loadItems:S,measurementStore:er,minCols:ei,renderItem:eF,scrollContainer:es,virtualBufferFactor:.3,virtualize:D}):(0,x.jsx)(l.Rk,{ref:eI?eT:e=>{w&&(w.current=e)},_dynamicHeights:!0,_fluidResize:eu,_getResponsiveModuleConfigForSecondItem:K,_logTwoColWhitespace:eb,align:a,columnWidth:et,getColumnSpanConfig:M,gutterWidth:en,items:eP,layout:ee?ea:v??"basic",loadItems:S,measurementStore:er,minCols:ei,renderItem:eF,scrollContainer:es,virtualBufferFactor:.3,virtualize:D})})]})})]})}},115247:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294);function i(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class l extends n.Component{constructor(...e){super(...e),i(this,"ref",(0,n.createRef)()),i(this,"observer",null),i(this,"handleVisibilityChanged",(e,a)=>{this.props.onVisibilityChange(e,a)})}componentDidMount(){this.ref&&this.ref.current&&(this.observer=new window.IntersectionObserver(this.handleVisibilityChanged,this.props.options),this.observer.observe(this.ref.current))}componentWillUnmount(){this.observer&&(this.observer.unobserve(this.ref.current),delete this.observer)}render(){return this.props.children(this.ref)}}let r=l},377654:function(e,a,t){t.d(a,{Rq:()=>n,Vf:()=>i,jd:()=>l,oy:()=>r});let n=e=>"ios"===e&&(window.devicePixelRatio||1)*window.screen.height==2436,i=28,l=e=>window.innerHeight>=748&&n(e),r=()=>"undefined"!=typeof window&&!!window.navigator&&(/iPad/.test(navigator.platform)||"MacIntel"===navigator.platform&&"ontouchend"in document&&Math.min(window.screen.width,window.screen.height)>=700)},914061:function(e,a,t){t.r(a),t.d(a,{default:()=>c});var n=t(281098),i=t(667294),l=t(20256),r=t(93966),s=t(377654),o=t(657389),d=t(15667),u=t(785893);let c=({children:e,dataLayoutShiftBoundaryId:a,hasFixedHeader:t=!1,hasGutter:c=!0,height:p,showKeychainError:g=!1,useViewport:m=!1})=>{(0,i.useEffect)(()=>{(0,n.Z)("MobilePageContainer","/app/packages/layout/MobilePageContainer.tsx")},[]);let h=(0,d.B)(),y=(0,s.jd)(h.userAgent.platform)?s.Vf:0;return(0,u.jsx)(l.xu,{"data-layout-shift-boundary-id":a||"PageContainer",height:m?`calc(100vh - ${y}px)`:p,paddingX:c?r.D6:void 0,paddingY:t||g?void 0:3,children:(0,u.jsx)(o.C,{value:!!c,children:e})})}},267828:function(e,a,t){t.d(a,{r:()=>n});function n(e,a,t){return!!(e&&e.trim().length>0&&a&&!t)}},918874:function(e,a,t){t.d(a,{Z:()=>s}),t(167912);var n,i=t(28427),l=t(19585);let r=(void 0!==n||(n=t(799956)).hash&&"01a93671cde480baa2cfd8b781589acd"!==n.hash&&console.error("The definition of 'useNormalizePinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),s=e=>{let a,t=(0,l.ZP)(),n=(0,i.Z)(r,e),s=n.trackedLink||n.link||n.imageSpec_orig&&n.imageSpec_orig.url,{richMetadata:o,richSummary:d}=n,u=t._('Saved from ', 'Closeup pin annotation', 'Closeup pin annotation');return o&&o.products&&o.products[0]&&o&&o.products[0].name&&o.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation'),a=(o.products?.[0]||void 0)?.offerSummary),!a&&d&&d&&d.products&&d.products[0]&&d&&d.products[0].name&&d.products[0].offerSummary&&(u=t._('Product sold by ', 'pin annotation', 'pin annotation')),{pinLink:s,pinCreditPrefix:u,pinTitle:n.closeupUnifiedTitle,pinDescription:n.closeupUnifiedDescription,pinCategory:n.category}}},636208:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a,t,i=0){if(-1===a||-1===t||a===t)return e;let l=t+i,r=a+i;if(l<0||l>=e.length||r<0||r>=e.length)return e;let s=[...e],o=s[r],d=r<l?1:-1;for(let a=r;a!==l;a+=d)s[a]=e[a+d];return s[l]=o,s}},123998:function(e,a,t){t.d(a,{Z:()=>_});var n=t(281098),i=t(667294),l=t(20256),r=t(390843),s=t(115247),o=t(15667),d=t(734215),u=t(998212),c=t(732888),p=t(738140),g=t(169053),m=t(785893);function h(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}class y extends i.Component{constructor(e){super(e),h(this,"componentWillUnmount",()=>{this.unregisterComponent()}),h(this,"getContext",()=>{let{clientTrackingParams:e,component:a,element:t,objectId:n,timeSpentContext:i,view:l,viewParameter:r}=this.props;return{view:l||i?.view,viewParameter:r||i?.viewParameter,component:a||i?.component,element:t,objectId:n||i?.objectId,clientTrackingParams:e||i?.clientTrackingParams,getParentUuid:()=>this.getUuid(),getGrandparentUuid:()=>this.getParentId()}}),h(this,"getLoggerContext",()=>{let e={...this.getContext()};return delete e.getParentUuid,e}),h(this,"getParentId",()=>{let{timeSpentContext:e,shouldUseGrandparentId:a=!1}=this.props;if(a&&e&&e.getGrandparentUuid){let a=e.getGrandparentUuid();if(a)return a}return e?.getParentUuid?.()}),h(this,"getUuid",()=>this.state.timedPair?this.state.timedPair.uuid:void 0),h(this,"getTimedPair",()=>this.state.timedPair),h(this,"setTimedPair",(e,a)=>{this.setState({timedPair:e},()=>{a&&a()})}),h(this,"isRegistered",!1),h(this,"registerComponent",()=>{this.props.timeSpentManager.registerComponent(this),this.isRegistered=!0}),h(this,"unregisterComponent",()=>{this.isRegistered&&(this.props.timeSpentManager.unregisterComponent(this),this.isRegistered=!1)}),h(this,"handleVisibilityChange",e=>{let{intersectionRatio:a}=e[0],{bottom:t,left:n,right:i,top:l}=e[0].intersectionRect;a>0?this.registerComponent():0===a&&(0===t&&0===n&&0===i&&0===l?this.unregisterComponent():this.registerComponent())}),this.state={timedPair:new c.Z(this.getLoggerContext())}}componentDidUpdate(e){!this.isRegistered||e.view===this.props.view&&e.viewParameter===this.props.viewParameter&&e.component===this.props.component&&e.element===this.props.element&&e.objectId===this.props.objectId&&(0,d.Z)(e.auxData,this.props.auxData)&&(0,d.Z)(e.viewData,this.props.viewData)||(this.unregisterComponent(),setTimeout(this.registerComponent))}render(){let{children:e,intersectionObserverBoxHeight:a}=this.props;return(0,m.jsx)(p.$,{value:this.getContext(),children:(0,m.jsx)(s.Z,{onVisibilityChange:this.handleVisibilityChange,options:{threshold:0},children:t=>(0,m.jsx)(l.xu,{ref:t,height:a??"100%",children:i.Children.only(e)})})})}componentDidMount(){(0,n.Z)("DeprecatedTimeSpent","/app/packages/time-spent/DeprecatedTimeSpent.tsx")}}function f(e){let a=(0,r.ou)(),t=(0,p.a)(),n=(0,u.Z)(),l=(0,g.EQ)(),{requestIdentifier:s=""}=(0,o.B)(),d={app_instance_id:s.slice(0,8),...e.auxData??{}};return(0,i.useEffect)(()=>{n?.setHistoryStackContext(a)},[a,n]),(0,i.useEffect)(()=>{n?.setPins(l??{})},[l,n]),n?(0,m.jsx)(y,{...e,auxData:d,timeSpentContext:t,timeSpentManager:n,children:e.children}):e.children}f.displayName="DeprecatedTimeSpent";let _=f},738140:function(e,a,t){t.d(a,{$:()=>n,a:()=>i});let{Provider:n,getMaybe:i}=(0,t(729434).Z)("timeSpentContext")},732888:function(e,a,t){t.d(a,{Z:()=>s,h:()=>r});var n=t(172045),i=t(17314);function l(e,a,t){var n;return(a="symbol"==typeof(n=function(e,a){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,a||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===a?String:Number)(e)}(a,"string"))?n:n+"")in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}let r="undefined"!=typeof window&&window.performance&&window.performance.now?()=>Math.floor((window.performance.timeOrigin+window.performance.now())*1e6):()=>1e6*Date.now(),s=class{constructor(e){l(this,"start",()=>(this.startTime=r(),this.startTime)),l(this,"end",()=>(this.endTime=r(),this.duration=this.startTime?this.endTime-this.startTime:null,this.duration));try{this.uuid=(0,n.Z)()}catch(e){this.uuid=(0,i.Z)()}e&&Object.assign(this,e)}}},359829:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let t=0,n=!1,i=-1;return e.forEach((e,l)=>{let{x:r=0,y:s=0,h:o=0,w:d=0}=e,u=function(e,a){let{x:t,y:n,w:i,h:l}=e,{x:r,y:s,w:o,h:d}=a,u=Math.max(t,r),c=Math.min(t+i,r+o),p=Math.max(n,s),g=Math.min(n+l,s+d),m=u<c&&p<g?(c-u)*(g-p):0;return m/(i*l+o*d-m)}(a,{x:r,y:s,h:o,w:d});u>=.9&&u>t&&(t=u,n=!0,i=l)}),{isCropAreaOnDotArea:n,indexToHide:i}}},611304:function(e,a,t){t.d(a,{Z:()=>n});function n(e){return{h:e?.h??void 0,is_stela:e?.isStela??void 0,labelId:e?.labelId??void 0,label_x:e?.labelX??void 0,label_y:e?.labelY??void 0,label:e?.label??void 0,max_annotation_num_documents:e?.maxAnnotationNumDocuments??void 0,score:e?.score??void 0,show_on_closeup:e?.showOnCloseup??void 0,title:e?.title??void 0,w:e?.w??void 0,x:e?.x??void 0,y:e?.y??void 0}}},739067:function(e,a,t){t.d(a,{Z:()=>n});function n(e,a){let{x:t,y:n}=e,i=!1,l=0,r=a.length-1;for(;l<a.length;){let{x:e,y:s}=a[l],{x:o,y:d}=a[r];s>n!=d>n&&t<(o-e)*(n-s)/(d-s)+e&&(i=!i),r=l,l+=1}return i}},897448:function(e,a,t){t.d(a,{Z:()=>c});var n,i=t(667294);t(167912);var l=t(382594);async function r(e){let a=new FormData;a.append("image",e);let{promise:t}=(0,l.Z)({url:"/camera-sam-segmentation/",type:"PUT",data:a}),n=await t,{data:i}=(await n.json()).responsePayload.resourceResponse;return i}var s=t(28427),o=t(675973),d=t(886981);let u=(void 0!==n||(n=t(160187)).hash&&"50c726067ab8af873ed4afded90b7bed"!==n.hash&&console.error("The definition of 'useSamSegmentation_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function c({boundingBox:e,pinKey:a,imageBlob:t,isCustomImage:n=!1}){let[l,c]=(0,i.useState)(null),{checkExperiment:p}=(0,o.Z)(),g=(0,s.Z)(u,a),m=p("dtn_exp6_uve4a").group,h=(0,i.useMemo)(()=>"enabled"===m?{detection_model:"dtn_exp6_yolov8",use_gss:!1,write_to_galaxy:!1}:"enabled_dtn_exp5_skip_gss"===m?{use_gss:!1,write_to_galaxy:!1}:{},[m]);(0,i.useEffect)(()=>{(async()=>{n&&t&&c(await r(t))})()},[n,t]);let{data:y}=(0,d.Z)(g&&g.entityId?{name:"ApiResource",options:{url:`/v3/pins/${g.entityId}/segmentation/sam/`,data:{bounding_box:e?JSON.stringify({x:Math.min(Math.max(e.x||0,0),1),y:Math.min(Math.max(e.y||0,0),1),width:Math.min(Math.max(e.w||1,0),1),height:Math.min(Math.max(e.h||1,0),1)}):void 0,client:"visual_cutout",use_gss:!e,write_to_galaxy:!e,cleanup_masks:!0,...h}}}:null);return n?l:y}},751961:function(e,a,t){t.d(a,{Z:()=>s});var n=t(281098),i=t(667294),l=t(366859),r=t(785893);let s=({children:e})=>((0,i.useEffect)(()=>{(0,n.Z)("FeedItemPinRepWrapper","/app/www/FeedItemPinRepWrapper.tsx")},[]),(0,r.jsx)(l.Z,{onTouch:e=>{if(e.target instanceof HTMLElement&&"IMG"===e.target.tagName){let a=e.target.getBoundingClientRect().top+window.scrollY-70;window.scrollTo(window.scrollX,a)}},pressState:"none",children:e}))},425140:function(e,a,t){t.d(a,{G:()=>x,Z:()=>v});var n=t(281098),i=t(667294),l=t(20256),r=t(469167),s=t(467925),o=t(93966),d=t(355363),u=t(62937),c=t(647709),p=t(341742),g=t(348268),m=t(357823),h=t(130858),y=t(79293),f=t(648200),_=t(785893);let x=25;function v({align:e,customLayoutType:a,getColumnSpanConfig:t,getResponsiveModuleConfigForSecondItem:x,emptyState:v,feedItems:S,feedKey:w,maxColumns:k,minColumns:b,pagination:{hasNext:P,isLoadingNext:F,loadNext:C,refetch:R},pullToRefresh:I,renderFeedItem:T,serverRender:j,isLoadingStateEnabled:E,isLoadingAccessibilityLabel:Z,isLoadedAccessibilityLabel:D,layout:M,forceShowLoadingState:K}){(0,i.useEffect)(()=>{(0,n.Z)("SimpleFeed","/app/www/SimpleFeed.tsx")},[]);let L=(0,c.HG)(),{experimentalColumnWidth:A,experimentalGutter:$}=(0,s.Z)(),[O,B]=(0,i.useState)(!1),N=1===k?window.innerWidth:void 0,z="userSearch"===a?window.innerWidth-16:200,U=F&&0===S.length&&!O&&!E,W="desktopFlashlight"===a||"ideaPage"===a&&L?-2:o.qG,H=b??2;return"userSearch"===a&&(H=1),(0,p.Z)(()=>(window.addEventListener("online",C),()=>window.removeEventListener("online",C))),(0,_.jsxs)(l.xu,{"data-test-id":"MobileFeed",children:[(0,_.jsx)(m.Z,{enabled:!!I,onPull:()=>{R(),B(!0)},refreshing:O}),(0,_.jsxs)(l.xu,{"data-test-id":"grid",marginEnd:W,marginStart:W,opacity:O?.5:1,children:[(0,_.jsx)(d.Z,{isAtEndOfFeed:!P,isPlaceholderGrid:E&&F&&!S.length,itemCount:S.length,children:S.length?(0,_.jsx)(l.xu,{"data-test-id":"feed",marginTop:(0,g.kk)({isDesktop:L}),children:(0,_.jsx)(u.Z.Consumer,{children:n=>(0,_.jsx)(i.Fragment,{children:(0,_.jsx)(f.Z,{children:(0,_.jsx)(r.default,{_getResponsiveModuleConfigForSecondItem:x,align:e||("ideaPage"===a?"start":void 0),cacheKey:w,columnWidth:L?A??o.yF:N??z,getColumnSpanConfig:t,gutterWidth:L?$??4*o.jC:void 0,id:j?w:void 0,isFetching:K??F,isLoadedAccessibilityLabel:D??"",isLoadingAccessibilityLabel:Z??"",isLoadingStateEnabled:K??!!E,items:K?[]:S,layout:M??void 0,loadItems:C,maxColumns:k,minCols:H,optOutFluidGridExperiment:null!=k,renderItem:({data:e,itemIdx:a})=>T(e,a),scrollContainerRef:n,serverRender:j})})})})}):F?(0,_.jsx)(h.Z,{}):v??null}),U&&(0,_.jsx)(l.xu,{column:12,paddingY:2,children:(0,_.jsx)(y.Z,{partialViewportWidth:"desktopFlashlight"===a})})]})]})}},290003:function(e,a,t){t.d(a,{Z:()=>eX});var n,i,l,r,s,o,d,u=t(281098),c=t(667294);t(167912);var p=t(20256),g=t(28427),m=t(801082),h=t(19585),y=t(886981),f=t(634737),_=t(825332),x=t(241646),v=t(583270),S=t(785893);function w({isTopRow:e,image:a}){return(0,c.useEffect)(()=>{(0,u.Z)("ShoppingUpsellStoryCardDetail","/app/common/react/components/shopping/ShoppingUpsellStoryCardDetail.tsx")},[]),(0,S.jsxs)(p.zd,{height:e?217:168,wash:!0,width:e?236:117,children:[a.url&&(0,S.jsx)(p.Ee,{alt:a.alt||"",fit:"cover",naturalHeight:a.height??1,naturalWidth:a.width??1,src:a.url}),!!a.price&&(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(255, 255, 255, 0.8)",borderRadius:"18px",color:"#111",fontSize:"10px",fontWeight:"600",lineHeight:"24px",padding:"06px"}},"data-test-id":"shopping-upsell-price",height:24,left:!0,margin:1,paddingX:2,paddingY:1,position:"absolute",top:!0,children:a.price})]})}var k=t(980787),b=t(744862),P=t(351607),F=t(97484),C=t(47426),R=t(483858),I=t(865690);let T={container:{borderRadius:`${F.Oc}px ${F.Oc}px 25px 25px`,WebkitMaskImage:"-webkit-radial-gradient(white, black)"},content:{marginBottom:"2px"},visualOverlay:{backgroundColor:"rgba(0, 0, 0, .1)"}},j=({images:e,firstImageIndex:a})=>{let t=a+1,n=a+2;return(0,S.jsxs)(p.xu,{overflow:"hidden",rounding:4,children:[(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:{__style:T.content},children:e.at(a)?(0,S.jsx)(w,{image:e[a],isTopRow:!0}):null}),e.length>n?(0,S.jsxs)(p.kC,{alignItems:"stretch",justifyContent:"between",children:[(0,S.jsx)(w,{image:e[t]}),(0,S.jsx)(w,{image:e[n]})]}):null]})};function E({dangerouslySetActionUrl:e,query:a,story:t,slotIndex:n}){let i,l,r,s,o;(0,c.useEffect)(()=>{(0,u.Z)("ShoppingUpsellStoryCard","/app/common/react/components/shopping/ShoppingUpsellStoryCard.tsx")},[]);let{logContextEvent:d}=(0,k.u)(),{action:g,id:m,objects:h,story_type:y,subtitle:f}=t,{text:_,url:x}=g||{},[v,w]=(0,c.useState)(!1),F=(0,c.useCallback)(()=>w(!0),[w]),E=(0,c.useCallback)(()=>w(!1),[w]),Z=(h||[]).reduce((e,a)=>"pin"!==a.type?e:[...e,{domain:a.domain,image:{alt:a.title||a.description,height:a.images?.["474x"]?.height,url:a.images?.["474x"]?.url,width:a.images?.["474x"]?.width,price:(a.rich_summary?.products?.[0]||{}).offer_summary?.price}}],[]),D=(Z[0]||{}).domain||void 0;["search_product_collage_story","shop_article_story"].includes(y)?(i=2,l=43,r={story_id:m,story_type:y,entered_query:a}):"shop_brand_story"===y||"shop_brand_affinity_story"===y?(i=1,l=92,D&&(r={story_type:y,commerce_data:JSON.stringify({domain:D})})):["stela_in_flashlight_card","stela_in_flashlight_onecol"].includes(y)?(i=72,l=3050):"related_domain_collage"===y?(i=72,l=3455):"related_products_collage"===y&&(i=1,l=3177);let M=()=>d({event_type:101,element:372,component:200,view_type:i,view_parameter:l,aux_data:{story_type:y}}),K=f?4:2;if(["related_domain_collage","shop_brand_story","shop_brand_affinity_story"].includes(y)&&g){let e=g.user;s=e&&(e.image_medium_url||e.image_large_url),o=e&&e.full_name}let L=e||x;if(!L)return null;let A=(0,C.Z)({url:L})?"nofollow":"none";return(0,S.jsx)(P.Fw,{componentType:200,contextLogData:r||{},impressionType:"Story",loggingId:y,slotIndex:n,viewParameter:l,viewType:i,children:({impressionTrackerRef:e})=>(0,S.jsx)(p.xu,{ref:e,children:(0,S.jsx)(p.Tg,{href:L,onTap:M,rel:A,children:(0,S.jsxs)(p.xu,{dangerouslySetInlineStyle:{__style:T.container},onMouseEnter:F,onMouseLeave:E,overflow:"hidden",position:"relative",children:[(0,S.jsx)(j,{firstImageIndex:+!!["related_domain_collage","related_products_collage"].includes(y),images:Z.map(({image:e})=>e)}),(0,S.jsx)(p.xu,{alignItems:"center",color:"secondary",display:"flex",justifyContent:"center",marginTop:2,paddingX:3,paddingY:K,rounding:"pill",children:(0,S.jsxs)(p.xu,{alignContent:"start",direction:"column",display:"flex",justifyContent:"center",margin:2,children:[f?(0,S.jsx)(p.xu,{marginBottom:1,children:(0,S.jsx)(p.xv,{align:"start",color:"subtle",children:f.format})}):null,(0,S.jsx)(p.xv,{align:"start",weight:"bold",children:_})]})}),o&&s&&(0,S.jsx)(p.xu,{margin:2,position:"absolute",right:!0,top:!0,children:(0,S.jsx)(b.qE,{name:o,outline:!0,size:"md",src:s})}),(0,S.jsx)(R.Z,{visibility:v?"visible":"none",children:(0,S.jsx)(I.Z,{additionalStyles:T.visualOverlay})})]})})})})}var Z=t(302148),D=t(941404);let M=(void 0!==n||(n=t(135885)).hash&&"610a35d46510240eb58e262c1909310c"!==n.hash&&console.error("The definition of 'BestPinCardAttribution_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n),K=()=>{(0,D.NC)("click_best_pin_board",!0)},L=()=>{(0,D.NC)("click_best_pin_profile",!0)},A=({pin:e})=>{let{pinner:a}=e,{username:t,fullName:n}=a??{},i=a?.imageMediumUrl||a?.imageSmallUrl,l=`/${t??""}/`;return(0,S.jsx)(p.Tg,{fullWidth:!1,href:l,onTap:L,rounding:"circle",children:(0,S.jsx)(b.qE,{name:n??"",outline:!0,size:"sm",src:i??""})})},$=({pin:e})=>{let a=(0,h.ZP)(),{board:t,pinner:n}=e,{name:i,privacy:l,url:r}=t??{},s=t?.entityId||"",{username:o,fullName:d}=n??{},u=`/${o??""}/`,c=(0,S.jsx)(p.xv,{inline:!0,size:"200",weight:"bold",children:(0,S.jsx)(p.rU,{display:"inlineBlock",href:u,onClick:L,underline:"hover",children:d})},d);return"protected"===l?(0,Z.nk)(a._('{{ pinnerName }} saved this Pin', 'Showing who saved this pin, but not which board (private board), on closeup', 'Showing who saved this pin, but not which board (private board), on closeup'),{pinnerName:c}):(0,Z.nk)(a._('{{ pinnerName }} saved to {{ boardName }}', 'Showing who saved this pin to which board on closeup', 'Showing who saved this pin to which board on closeup'),{pinnerName:c,boardName:(0,S.jsx)(p.xv,{inline:!0,size:"200",weight:"bold",children:(0,S.jsx)(p.rU,{href:r??"",onClick:K,children:i},"board")},s)})},O=({pinKey:e})=>{(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardAttribution","/app/packages/BestPinCard/BestPinCardAttribution.tsx")},[]);let a=(0,g.Z)(M,e);return(0,S.jsxs)(p.xu,{alignItems:"center","data-test-id":"pin-attribution",direction:"row",display:"flex",marginTop:3,children:[(0,S.jsx)(A,{pin:a}),(0,S.jsx)(p.xu,{marginEnd:2}),(0,S.jsx)(p.xv,{size:"200",children:(0,S.jsx)($,{pin:a})})]})},B=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="underline")},N=e=>{e.target&&e.target instanceof HTMLElement&&(e.target.style.textDecoration="none")};var z=t(521009);function U({pageType:e,pinCreditPrefix:a,pin:t,pinLink:n,viewParameter:i}){(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardClickthroughLink","/app/packages/BestPinCard/BestPinCardClickthroughLink.tsx")},[]);let l=(0,h.ZP)(),r=(0,z.Z)();if("topic"!==e.page&&(!t.domain||"Uploaded by user"===t.domain))return null;let s="topic"!==e.page||e.isAuth?"100":"200",o="topic"===e.page&&!!t.nativeCreator,d=o?t.nativeCreator?.fullName:t.domain;return(0,S.jsx)(p.xu,{display:"flex",flex:"none",justifyContent:"start",marginBottom:2,children:(0,S.jsx)(p.rU,{display:"inlineBlock",href:o?`/${t.nativeCreator?.username||""}/`:n,onClick:()=>{"topic"===e.page?(0,D.NC)("click_topic_best_pin_link"):r({event_type:12,view_type:3,object_id_str:t.entityId,component:85,view_parameter:i})},rel:"nofollow",target:"blank",underline:"hover",children:(0,S.jsx)(p.xv,{size:s,children:(0,Z.nk)(l._('{{ pinCreditPrefix }} {{ pinCredit }}', 'Tells the user where the pin is from in the form of "Saved from <website>"', 'Tells the user where the pin is from in the form of "Saved from <website>"'),{pinCreditPrefix:a,pinCredit:(0,S.jsx)(p.xv,{inline:!0,size:s,weight:"bold",children:"topic"!==e.page?(0,S.jsxs)("span",{"data-gestalt-valid-html":"Text",onBlur:N,onFocus:B,onMouseLeave:N,onMouseOver:B,children:[" ",t.domain]}):d},o?"creatorProfile":"pinLinkDomain")})})})})}var W=t(166379),H=t(110870),V=t(267828),G=t(695263),Y=t(918874),X=t(873408),q=t(776250),Q=t(492841),J=t(594414);let ee=(void 0!==i||(i=t(815025)).hash&&"12f77507a9fdec344b44b7e659fa5ac1"!==i.hash&&console.error("The definition of 'RecipeMetadata_recipe' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function ea({recipeKey:e}){(0,c.useEffect)(()=>{(0,u.Z)("RecipeMetadata","/app/packages/recipePin/RecipeMetadata.tsx")},[]);let a=(0,g.Z)(ee,e);if(a?.aggregateRating?.ratingValue&&a.aggregateRating.reviewCount){let e="number"==typeof a.cookTimes?.cook?.m&&"number"==typeof a.cookTimes.prep?.m?`${a.cookTimes.cook.m+a.cookTimes.prep.m} minutes \xb7 `:"";return(0,S.jsxs)(c.Fragment,{children:[(0,S.jsx)(J.Z,{max_rating:a.aggregateRating.bestRating,rating:a.aggregateRating.ratingValue},a.aggregateRating.ratingValue),(0,S.jsx)(p.xv,{inline:!0,size:"200",children:` ${a.aggregateRating.reviewCount} \xb7 ${e}`})]})}return null}var et=t(15667);let en=(void 0!==l||(l=t(5375)).hash&&"81db65fd15680cc0281b801ed4a8cb94"!==l.hash&&console.error("The definition of 'BestPinCardBody_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function ei(e){(0,c.useEffect)(()=>{(0,u.Z)("BestPinCardBody","/app/packages/BestPinCard/BestPinCardBody.tsx")},[]);let{pinKey:a,viewportSize:t,pageType:n}=e,i=(0,g.Z)(en,a),{pinCreditPrefix:l,pinLink:r}=(0,Y.Z)(i),s=(0,X.Z)(i),{description:o}=(0,G.eK)({richMetadataDescription:i.richMetadata?.description,richSummaryDisplayName:i.richSummary?.displayName,closeupUnifiedDescription:i.closeupUnifiedDescription});"videos_category"===n.page&&(o=(0,G.kt)(o,i.nativeCreator?.username||""));let d="wide"===t,m=(0,G.Ly)({pinTitle:i.title,gridTitle:i.gridTitle,richSummaryDisplayName:i.richSummary?.displayName??"",richMetadataTitle:i.richMetadata?.title??"",storyPinDataId:i.storyPinDataId,storyPinDataMetadataPinTitle:i.storyPinData?.metadata?.pinTitle,pinJoinVisualAnnotation:i.pinJoin?.visualAnnotation});(i.gridTitle||"").trim()&&m!==i.gridTitle&&(m=(0,G.EU)(i.gridTitle,200));let h=(0,V.r)(i.richMetadata?.recipe?.name,!!i.richMetadata?.recipe?.categorizedIngredients,i.richMetadata?.recipe?.fromAggregatedData??!1)?i.richMetadata?.recipe:null,y=!!(i.richMetadata&&i.richMetadata.article&&i.richMetadata.article.datePublished)&&((e,a)=>{let t=new Date((e.richMetadata??{}).article?.datePublished??Date.now()),n=t.getTime();return new Date().getTime()-n<=63072e6?(0,S.jsx)(W.Z,{dateFormatType:W.k.LONG_MONTH_YEAR,useUTC:!1,value:t}):""})(i,0),f=(e=>{let a,t,n="";if(e.richMetadata&&e.richMetadata.article&&e.richMetadata.article.datePublished)return n;let i=(a=null,e.lastRepinDate&&(a=new Date(e.lastRepinDate)),t=null,(e.createdAt&&(t=new Date(e.createdAt)),a)?t?a>t?a:t:a:t);if(i&&i.getFullYear()===new Date().getFullYear()){let a=new Set(["film_music_books","art","home_decor","food_drink","womens_fashion","travel","weddings","hair_beauty","holidays_events","mens_fashion","products","celebrities","technology"]),{category:t}=e;a.has(t)&&(n=i?(0,S.jsx)(W.Z,{dateFormatType:W.k.LONG_MONTH_YEAR,useUTC:!1,value:i}):"")}return n})(i)||y,{isBot:_,isSocialBot:x}=(0,et.B)();return(0,S.jsx)(p.xu,{alignContent:"between","data-test-id":"UnauthBestPinCardBodyContainer",direction:"column",display:"flex",flex:"grow",padding:8,position:"relative",width:"100%",children:(0,S.jsxs)(p.xu,{direction:"column",display:"flex",flex:"grow",position:"relative",children:[(0,S.jsx)(U,{pageType:n,pin:{entityId:i.entityId,domain:i.domain||"",nativeCreator:i.nativeCreator&&{fullName:i.nativeCreator.fullName,username:i.nativeCreator.username}},pinCreditPrefix:"topic"===n.page&&i.nativeCreator?"Created by":l,pinLink:r??"",viewParameter:(0,q.Z)({hasPin:!0,hasPinRichMetadata:!!i.richMetadata,hasPinRichMetadataProducts:!!i.richMetadata?.products,hasPinRichMetadataArticle:!!i.richMetadata?.article,hasPinRichMetadataRecipe:!!i.richMetadata?.recipe,hasPinStoryPinData:!!i.storyPinData})}),(0,S.jsx)(p.kC,{direction:"row",justifyContent:"between",children:(0,S.jsx)(p.xu,{display:"flex",marginEnd:3*!d,marginTop:3*!!d,overflow:"hidden",children:m&&(0,S.jsx)("h2",{"data-test-id":"UnauthBestPinCardTitle",style:{fontWeight:600,fontSize:"28px",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:m})})}),f?(0,S.jsx)(p.xu,{marginTop:1,children:(0,S.jsx)(p.xv,{color:"subtle",children:f})}):null,o&&(0,S.jsx)(p.xu,{display:"flex",marginTop:3,overflow:"hidden",children:(0,S.jsxs)("h3",{style:{fontWeight:"normal",overflow:"hidden",display:"-webkit-box",WebkitLineClamp:3,WebkitBoxOrient:"vertical",fontSize:"14px"},children:[h&&(0,S.jsx)(ea,{recipeKey:h}),o]})}),h&&(0,S.jsx)(Q.Z,{marginOverrides:h?{outerMarginTop:32,ingredientMarginBottom:4}:null,recipeProps:{recipe:{categorizedIngredients:h.categorizedIngredients,name:h.name,image:(0,H.Z)({imagesUrls:s,embedSrc:i.embed?.src,embedType:i.embed?.type,excludeOriginals:!_&&!x})}}}),(0,S.jsx)(p.xu,{alignItems:"center",direction:"row",display:"flex",justifyContent:"between",marginTop:2,children:(0,S.jsx)(O,{pinKey:i})})]})})}var el=t(642407),er=t(633301);let es={nw:0,ne:90,se:180,sw:270},eo={ne:[7,-7],se:[7,7],sw:[-7,7],nw:[-7,-7]},ed={nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};function eu({corner:e,x:a,y:t,size:n,cornerStyle:i}){return(0,c.useEffect)(()=>{(0,u.Z)("CropperCorner","/app/packages/Cropper/CropperCorner.tsx")},[]),(0,S.jsxs)("g",{"data-test-id":`cropper-corner-${e}`,style:{cursor:ed[e],pointerEvents:"auto"},transform:((e,a,t,n)=>{if("rounded"!==n)return`translate(${a}, ${t}), rotate(${es[e]})`;{let[n,i]=eo[e];return`translate(${a+n}, ${t+i}), rotate(${es[e]})`}})(e,a,t,i),children:[(0,S.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:n,stroke:"none",width:n,x:0,y:0}),"rounded"===i?(0,S.jsx)("path",{className:`cropperHandle ${e}`,d:"M16 0H24V8H16C11.5817 8 8 11.5817 8 16V24H0V16C0 7.16343 7.16345 0 16 0Z",fill:"#fff"}):(0,S.jsx)("path",{className:`cropperHandle ${e}`,d:`M ${n} 0 L 0 0 L 0 ${n}`,fill:"none",stroke:"#fff",strokeWidth:6})]})}let ec={n:"ns-resize",s:"ns-resize",e:"ew-resize",w:"ew-resize"};function ep({edge:e,x:a,y:t,w:n,h:i}){return(0,c.useEffect)(()=>{(0,u.Z)("CropperEdge","/app/packages/Cropper/CropperEdge.tsx")},[]),(0,S.jsx)("rect",{className:`cropperHandle ${e}`,fill:"rgba(0,0,0,0)",height:i,stroke:"none",style:{cursor:ec[e],pointerEvents:"auto"},width:n,x:a,y:t})}function eg({x:e,y:a,w:t,h:n}){(0,c.useEffect)(()=>{(0,u.Z)("CropperHandles","/app/packages/Cropper/CropperHandles.tsx")},[]);let i="rounded";return(0,S.jsxs)(c.Fragment,{children:[(0,S.jsx)(eu,{corner:"nw",cornerStyle:i,size:20,x:e,y:a}),(0,S.jsx)(eu,{corner:"ne",cornerStyle:i,size:20,x:e+t,y:a}),(0,S.jsx)(eu,{corner:"sw",cornerStyle:i,size:20,x:e,y:a+n}),(0,S.jsx)(eu,{corner:"se",cornerStyle:i,size:20,x:e+t,y:a+n}),(0,S.jsx)(ep,{edge:"n",h:30,w:Math.max(t-40,0),x:e+20,y:a-10}),(0,S.jsx)(ep,{edge:"e",h:Math.max(n-40,0),w:30,x:e+t-20,y:a+20}),(0,S.jsx)(ep,{edge:"s",h:30,w:Math.max(t-40,0),x:e+20,y:a+n-10}),(0,S.jsx)(ep,{edge:"w",h:Math.max(n-40,0),w:30,x:e-20,y:a+20})]})}var em=t(598600),eh=t(187356),ey=t(369416),ef=t(341742),e_=t(378547);function ex(e){(0,c.useEffect)(()=>{(0,u.Z)("Cropper","/app/packages/Cropper/Cropper.tsx")},[]);let{children:a,cropArea:t,imageSize:n,objectDetection:i,onChange:l,previewCropArea:r,showPreviewArea:s,viewParameter:o,viewType:d}=e,g=(0,z.Z)(),m=(0,c.useRef)(null),h=(0,c.useRef)(null),[y,f]=(0,c.useState)(0),[_,x]=(0,c.useState)(0),[v,w]=(0,c.useState)(0),[k,b]=(0,c.useState)(0),[P,F]=(0,c.useState)((0,em.Z)({cropArea:t,imageSize:n})),[C,R]=(0,c.useState)(null),[I,T]=(0,c.useState)(null),[j,E]=(0,c.useState)(!1),[Z,D]=(0,c.useState)(!1),M=e=>{e.preventDefault(),e.stopPropagation();let{clientX:a,clientY:t}=e,n=a-y,i=t-_;D(!1),w(n),b(i);let l=e.target,r=l.classList.contains("cropperHandle"),s="shadowMask"===l.id,o="cropSection"===l.id,d=l.id===eh.P,u=l.id===e_.I;r?(R("resize"),l.classList.contains("ne")?T("ne"):l.classList.contains("nw")?T("nw"):l.classList.contains("se")?T("se"):l.classList.contains("sw")?T("sw"):l.classList.contains("n")?T("n"):l.classList.contains("s")?T("s"):l.classList.contains("e")?T("e"):l.classList.contains("w")&&T("w")):s?(R("select"),F(el.OI)):o?R("move"):(P.x<n&&n<P.x+P.w&&P.y<i&&i<P.y+P.h?R("move"):(R("select"),F(el.OI)),E(d||u))},K=e=>{if(!C)return;E(!1);let{clientX:a,clientY:t}=e,i=a-y,l=t-_;if("resize"===C){let e=Math.max(Math.min(i,(n.width??1)-el.SP),el.SP),a=Math.max(Math.min(l,(n.height??1)-el.SP),el.SP),{x:t,y:r,w:s,h:o}=P;switch(I){case"ne":e<t&&a>r+o?T("sw"):e<t?T("nw"):a>r+o&&T("se");break;case"nw":e>t+s&&a>r+o?T("se"):e>t+s?T("ne"):a>r+o&&T("sw");break;case"se":e<t&&a<r?T("nw"):e<t?T("sw"):a<r&&T("ne");break;case"sw":e>t+s&&a<r?T("ne"):e>t+s?T("se"):a<r&&T("nw");break;case"n":a>r+o&&T("s");break;case"s":a<r&&T("n");break;case"e":e<t&&T("w");break;case"w":e>t+s&&T("e")}switch(I){case"ne":F(({x:t,y:n,h:i})=>{let l=Math.max(e-t,el.xZ),r=Math.max(i+(n-a),el.xZ);return{x:t,y:r<=el.xZ?n:a,w:l,h:r}});break;case"nw":F(({x:t,y:n,w:i,h:l})=>{let r=Math.max(i+(t-e),el.xZ),s=Math.max(l+(n-a),el.xZ);return{x:r===el.xZ?t:e,y:s===el.xZ?n:a,w:r,h:s}});break;case"se":F(({x:t,y:n})=>{let i=Math.max(e-t,el.xZ),l=Math.max(a-n,el.xZ);return{x:t,y:n,w:i,h:l}});break;case"sw":F(({x:t,y:n,w:i})=>{let l=Math.max(i+(t-e),el.xZ),r=Math.max(a-n,el.xZ);return{x:l===el.xZ?t:e,y:n,w:l,h:r}});break;case"n":F(({x:e,y:t,w:n,h:i})=>{let l=Math.max(t-a+i,el.xZ);return{x:e,y:l===el.xZ?t:a,w:n,h:l}});break;case"s":F(({x:e,y:t,w:n})=>{let i=Math.max(a-t,el.xZ);return{x:e,y:t,w:n,h:i}});break;case"e":F(({x:a,y:t,h:n})=>{let i=Math.max(e-a,el.xZ);return{x:a,y:t,w:i,h:n}});break;case"w":F(({x:a,y:t,w:n,h:i})=>{let l=Math.max(n-e+a,el.xZ);return{x:l===el.xZ?a:e,y:t,w:l,h:i}})}}else if("move"===C){let e=i-v,a=l-k,t=Math.max(Math.min(P.x+e,(n.width??1)-P.w-el.SP),el.SP),r=Math.max(Math.min(P.y+a,(n.height??1)-P.h-el.SP),el.SP);w(i),b(l),F(({w:e,h:a})=>({x:t,y:r,w:e,h:a}))}else if("select"===C){let e=Math.max(Math.min(i,n.width??1),0),a=Math.max(Math.min(l,n.height??1),0);F({x:Math.min(v,e),y:Math.min(k,a),w:Math.abs(e-v),h:Math.abs(a-k)})}},L=()=>{if(R(null),T(null),E(!1),C){if(j&&"dots"===i)return void D(!0);if(0===P.w&&0===P.h)l({cropArea:{x:el.SP,y:el.SP,w:(n.width??1)-2*el.SP,h:(n.height??1)-2*el.SP},cropSource:5}),g({event_type:16586,view_type:d,view_parameter:o});else{let e,a,t=Math.max(Math.min(P.x,(n.width??1)-el.xZ-el.SP),el.SP),i=Math.max(Math.min(P.y,(n.height??1)-el.xZ-el.SP),el.SP);e=P.h<el.xZ?el.xZ:i+P.h>(n.height??1)-el.SP?(n.height??1)-i-el.SP:P.h,a=P.w<el.xZ?el.xZ:t+P.w>(n.width??1)-el.SP?(n.width??1)-t-el.SP:P.w,"move"===C?g({event_type:7603,view_type:d,view_parameter:o}):"resize"===C?g({event_type:7604,view_type:d,view_parameter:o}):"select"===C&&g({event_type:16584,view_type:d,view_parameter:o}),l({cropArea:{x:t,y:i,w:a,h:e},cropSource:6})}}};return(0,ef.Z)(()=>{if(h.current){let{x:e,y:a}=h.current.getBoundingClientRect();f(e),x(a)}}),(0,c.useEffect)(()=>{Z&&F(t??el.OI)},[t,Z]),(0,c.useEffect)(()=>{let e=h.current;return e&&(e.addEventListener("mousedown",M),window.addEventListener("mousemove",K),window.addEventListener("mouseup",L)),()=>{e&&(e.removeEventListener("mousedown",M),window.removeEventListener("mousemove",K),window.removeEventListener("mouseup",L))}}),(0,S.jsxs)(p.xu,{ref:h,dangerouslySetInlineStyle:{__style:{cursor:"crosshair"}},"data-test-id":"visual-search-cropper",height:"100%",left:!0,position:"absolute",top:!0,width:"100%",children:[(0,S.jsx)(ey.Z,{unsafeCSS:el.iC}),(0,S.jsxs)("svg",{"data-gestalt-valid-html":"Box",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%"},children:[(0,S.jsx)("defs",{children:(0,S.jsxs)("mask",{id:"Mask",children:[(0,S.jsx)("rect",{fill:"white",height:n.height??"100%",rx:"0",ry:"0",width:n.width??"100%",x:"0",y:"0"}),(0,S.jsx)("rect",{height:P.h,id:"hole",rx:0,ry:0,width:P.w,x:P.x,y:P.y},`${P.x}${P.y}`),(0,S.jsx)(er.Z,{classNames:"preview-crop-area",in:s&&!C,mountOnEnter:!0,nodeRef:m,timeout:300,unmountOnExit:!0,children:(0,S.jsx)(p.xu,{ref:m,children:(0,S.jsx)("rect",{height:r.h,id:"preview",rx:4,ry:4,width:r.w,x:r.x,y:r.y},`${r.x}${r.y}`)})})]})}),(0,S.jsx)("rect",{fill:"rgba(0,0,0,0.5)",height:"100%",id:"shadowMask",mask:"url(#Mask)",width:"100%",x:"0",y:"0"}),(0,S.jsx)("use",{className:"v2cropSection","data-test-id":"cropper-section",fill:"rgba(0,0,0,0)",href:"#hole",id:"cropSection",stroke:"white",strokeWidth:"2",style:{cursor:"move"}})]}),a,(0,S.jsx)("svg",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"},children:"select"!==C&&(0,S.jsx)(eg,{h:P.h,w:P.w,x:P.x,y:P.y})})]})}var ev=t(941023),eS=t(359829),ew=t(74678),ek=t(556872),eb=t(611304);let eP=(void 0!==r||(r=t(584411)).hash&&"939d46d8644385a7918ed8179ce77a4c"!==r.hash&&console.error("The definition of 'UnauthCropperContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eF({cropArea:e,customCropper:a,imageSignature:t,imageSize:n,pinKey:i,showAnimation:l,trafficSource:r,viewParameter:s,viewType:o}){(0,c.useEffect)(()=>{(0,u.Z)("UnauthCropperContainer","/app/packages/Flashlight/UnauthCropperContainer.tsx")},[]);let d=(0,g.Z)(eP,i),[p,m]=(0,c.useState)("none"),[h,y]=(0,c.useState)(!1),[f,_]=(0,c.useState)({x:0,y:0,w:0,h:0}),[x,v]=(0,c.useState)({isCropAreaOnDotArea:!1,indexToHide:-1}),{indexToHide:w}=x,k=(0,c.useMemo)(()=>(d.visualObjects??[]).filter(e=>e.isStela).map(eb.Z),[d.visualObjects]);return(0,c.useEffect)(()=>{let a=k&&!!k.length,t=(0,ew.Z)({cropArea:e,scaledHeight:n.height??0,scaledWidth:n.width??0});a&&(m("dots"),v((0,eS.Z)(k,t)))},[e,n.height,n.width,k]),(0,S.jsx)(ex,{cropArea:e,imageSize:n,objectDetection:p,onChange:a,previewCropArea:f,showPreviewArea:!1,viewParameter:s,viewType:o,children:"dots"===p&&(0,S.jsx)(ev.Z,{currentSpotlightIdx:w,handleSpotlightClick:e=>{let{x:t,y:i,w:l,h:s,title:o}=k[e];a({cropArea:(0,ek.Z)({cropArea:{x:t,y:i,w:l,h:s},scaledHeight:n.height??0,scaledWidth:n.width??0}),cropSource:4,trafficSource:r,title:o||""})},handleSpotlightHover:e=>{if(e===w)return;let{x:a,y:t,w:i,h:l}=k[e];_((0,ek.Z)({cropArea:{x:a,y:t,w:i,h:l},scaledWidth:n.width??0,scaledHeight:n.height??0})),y(!0)},handleSpotlightUnhover:()=>{y(!1)},imageSignature:t,imageSize:n,pinKey:d,showAnimation:l,viewParameter:s,viewType:o})},JSON.stringify(e))}var eC=t(506662),eR=t(728994),eI=t(123998),eT=t(572227),ej=t(351222),eE=t(378888),eZ=t(870358),eD=t(85363),eM=t(845421),eK=t(588836),eL=t(425140),eA=t(430635);let e$=0,eO="",eB=(void 0!==s||(s=t(579652)).hash&&"93612431e09eadc717c32d98e8d91e06"!==s.hash&&console.error("The definition of 'UnauthDesktopFlashlightPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function eN(e){let{imageSpec_564x:a,imageSpec_orig:t,imageSignature:n}=e,i=a&&t,{url:l}=i??{},r=i?.width??1,s=i?.height??void 0;return"number"==typeof r&&"number"==typeof s&&r>564&&(s*=564/r,r=564),{width:r,height:s,url:l,imageSignature:n}}let ez=({data:e,index:a,viewParameter:t,productsURL:n})=>{switch(e.type){case"pin":return(0,S.jsx)(eM.Z,{duploQueryRef:null,pinId:e.id,slotIndex:a,viewParameter:t,viewType:72});case"story":return n&&(0,S.jsx)(E,{dangerouslySetActionUrl:n,slotIndex:a,story:e});default:return null}},eU=({resourceOptions:e})=>{let a=(0,h.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:l}=(0,y.Z)({name:"VisualLiveSearchResource",options:e}),r=(0,_.TH)(),s=`${r.pathname}products/${r.search}`;return(0,S.jsxs)(c.Fragment,{children:[t&&(0,S.jsx)(eL.Z,{customLayoutType:"desktopFlashlight",feedItems:t.results||[],feedKey:"flashlight-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>ez({data:e,index:a,viewParameter:3050,productsURL:s})}),(0,S.jsx)(p.xH,{accessibilityLabel:a._('Loading visual search results...', 'unauthDesktopVisualSearch.flashlightFeed.loading', 'Accessibility label for loading visual search results'),show:i})]})},eW=({resourceOptions:e})=>{let a=(0,h.ZP)(),{data:t,isAtEnd:n,isFetching:i,fetchMore:l}=(0,y.Z)({name:"VisualLiveSearchProductFeedResource",options:e});return(0,S.jsxs)(c.Fragment,{children:[t&&(0,S.jsx)(eL.Z,{customLayoutType:"desktopFlashlight",feedItems:t||[],feedKey:"flashlight-products-dweb-unauth",pagination:{loadNext:l,hasNext:n,isLoadingNext:i,refetch:()=>void 0},renderFeedItem:(e,a)=>ez({data:e,index:a,viewParameter:3334})}),(0,S.jsx)(p.xH,{accessibilityLabel:a._('Loading visual search product results...', 'unauthDesktopVisualSearch.flashlightProductFeed.loading', 'Accessibility label for loading visual search product results'),show:i})]})};function eH({pinKey:e}){(0,c.useEffect)(()=>{(0,u.Z)("UnauthDesktopFlashlightPage","/app/www/VisualSearch/UnauthDesktopFlashlightPage.tsx")},[]);let a=(0,h.ZP)(),{isRTL:t}=(0,et.B)(),n=(0,z.Z)(),i=(0,_.s0)(),l=(0,_.TH)(),r=(0,c.useRef)(null),s=(0,eA.Z)(),o=(0,eT.Z)(),{pinId:d}=(0,f.Z)(s.params.id||""),m=(0,eE.mB)(l.search),y=(0,v.Z)(l),w=function(e){let a=parseInt(e??"",10);switch(a){case 1:case 2:case 3:case 4:case 5:case 6:return a;default:return}}(m.cropSource),k=(0,eC.hd)(l),b=(0,g.Z)(eB,e),{getNormalizedPinImage:P}=(0,eR.Z)({pinKey:b});if((0,c.useEffect)(()=>{if(!y&&b){let{width:e,height:a}=P();i((0,eD.Z)({cropArea:{h:a-2*el.SP,w:e-2*el.SP,x:el.SP,y:el.SP},isProductPage:k,pinId:d,surfaceType:"flashlight"}),{replace:!0})}},[P,i,y,k,b,d]),(0,ef.Z)(()=>{n({event_type:13,view_type:72,view_parameter:3050,view_data:{pin_id:d}})}),(0,c.useEffect)(()=>{let e=r.current;return e&&eO===d&&(e.scrollTop=e$),()=>{e&&(e$=e.scrollTop,eO=d)}}),!b)return(0,S.jsx)(eI.Z,{objectId:"",view:72,children:(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:{__style:{top:ej.Pw}},position:"relative",children:(0,S.jsx)(p.xH,{accessibilityLabel:a._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0})})});let{imageSignature:F,description:C}=b,{width:R,height:I,url:T}=eN(b),j=function({initialCropArea:e,pin:a}){let t;if(e)t={...e};else{let{visualObjects:e}=a,{width:n=1,height:i=1}=eN(a);if(e&&e.length){let{x:a,y:l,w:r,h:s}=e[0];t=(0,ek.Z)({cropArea:{x:a,y:l,w:r,h:s},scaledWidth:n,scaledHeight:i})}else{let[e,a]=[n/6,i/6],[l,r]=[n-2*e,i-2*a];t={x:e,y:a,w:l,h:r}}}return{x:Math.floor(t.x??0),y:Math.floor(t.y??0),w:Math.floor(t.w??0),h:Math.floor(t.h??0)}}({initialCropArea:y,pin:b}),E=l.state&&l.state.internalNavigation,Z=R+x.n,D=(Z??1)+24,M={pin_id:d,imageSignature:F,crop:(0,ew.Z)({cropArea:j,scaledWidth:R,scaledHeight:I}),crop_source:w||5},K={__style:{top:140}};return(0,S.jsx)(eI.Z,{objectId:"",view:72,children:(0,S.jsxs)(c.Fragment,{children:[(0,S.jsxs)(p.xu,{alignItems:"center",color:"default",dangerouslySetInlineStyle:{__style:{top:80}},display:"flex",height:60,position:"fixed",width:"100%",zIndex:new p.Ry(4),children:[!t&&(0,S.jsx)(p.xu,{left:!0,position:"absolute",children:(0,S.jsx)(eK.Z,{})}),(0,S.jsx)(p.xu,{flex:"grow",children:(0,S.jsx)(p.X6,{align:"center",size:"400",children:k?a._('Shop similar items', 'unauthDesktopFlashlightPage.flashlightProductsFeed.header', 'Header explaining results of flashlight products search'):a._('Visually similar results', 'unauthDesktopFlashlightPage.flashlightFeed.header', 'Header explaining results of flashlight search')})}),t&&(0,S.jsx)(p.xu,{position:"absolute",right:!0,children:(0,S.jsx)(eK.Z,{icon:"directional-arrow-left"})})]}),k?(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:K,position:"relative",children:(0,S.jsx)(eW,{resourceOptions:M})}):(0,S.jsxs)(p.xu,{display:"flex",paddingX:12,children:[(0,S.jsxs)(p.xu,{ref:r,dangerouslySetInlineStyle:K,height:"calc(100% - 140px)",marginEnd:3,marginStart:3,overflow:"auto",position:"fixed",width:Z,zIndex:new p.Ry(4),children:[(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:{__style:{width:R,height:I}},"data-test-id":"flashlight-enabled-image",children:(0,S.jsxs)(p.zd,{height:I,rounding:2,width:R,children:[T&&(0,S.jsx)(p.Ee,{alt:C??"",naturalHeight:I??1,naturalWidth:R??1,src:T}),(0,S.jsx)(eF,{cropArea:j,customCropper:function({cropArea:e,cropSource:a}){let t=window.location.pathname+window.location.search,n=(0,eD.Z)({cropArea:e,cropSource:a??6,isProductPage:k,pinId:d,surfaceType:"flashlight"});o({action:"trigger",item:"cropper-changed",within:"flashlight-page"}),n!==t&&d&&i({pathname:`/pin/${d}/visual-search/`,search:(0,eZ.Z)({cropArea:e,cropSource:a??6,surfaceType:"flashlight"})},{state:{internalNavigation:!0}})},imageSignature:F??void 0,imageSize:{height:I,width:R},pinKey:b,showAnimation:!E,surfaceType:"flashlight",viewParameter:3050,viewType:72})]})}),(0,S.jsx)(p.xu,{"data-test-id":"closeupDescription",direction:"column",display:"flex",margin:5,maxWidth:R??1,position:"relative",children:(0,S.jsx)(ei,{pageType:{isAuth:!1,page:"flashlight"},pinKey:b,viewportSize:"narrow"})})]}),(0,S.jsx)(p.xu,{dangerouslySetInlineStyle:{__style:{...K.__style,...t?{marginRight:`${D}px`}:{marginLeft:`${D}px`}}},position:"relative",width:"100%",children:(0,S.jsx)(eU,{resourceOptions:M})})]})]})})}let eV=(void 0!==o||(o=t(514336)).hash&&"01839fc3bcd9cdaf206873364167d157"!==o.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o),eG=(void 0!==d||(d=t(165135)).hash&&"c1c702b23a1454b46f8e2fa9d8036257"!==d.hash&&console.error("The definition of 'UnauthDesktopFlashlightPageFetchDataPinQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function eY(){let e=(0,eA.Z)(),{pinId:a}=(0,f.Z)(e.params.id||""),t=(0,m.Z)({strategy:"Legacy",query:eG,variables:{pinId:a},useGetLegacyData:({pinId:e})=>(0,y.Z)({name:"PinResource",options:{id:e,field_set_key:"detailed",fetch_visual_search_objects:!0}}).data}),n=t?.v3GetPinQuery?.__typename==="V3GetPin"?t.v3GetPinQuery.data:null,i=(0,g.Z)(eV,n);return(0,S.jsx)(eH,{pinKey:i})}function eX(){(0,c.useEffect)(()=>{(0,u.Z)("UnauthDesktopFlashlightPageFetchData","/app/www/VisualSearch/UnauthDesktopFlashlightPageFetchData.tsx")},[]);let e=(0,h.ZP)();return(0,S.jsx)(c.Suspense,{fallback:(0,S.jsx)(p.xH,{accessibilityLabel:e._('Loading Pin data', 'unauthDesktopFlashlightPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:(0,S.jsx)(eY,{})})}},551651:function(e,a,t){t.d(a,{Z:()=>u});var n=t(281098),i=t(667294),l=t(346955),r=t(503246),s=t(706753),o=t(785893);class d extends i.Component{componentDidMount(){let{setCurrentPageData:e,viewData:a,viewParameter:t,viewType:n}=this.props;e({viewData:a,viewParameter:t,viewType:n})}componentDidUpdate(e){let{setCurrentPageData:a,viewData:t,viewParameter:n,viewType:i}=this.props;n===e.viewParameter&&i===e.viewType&&(0,r.ZP)(t,e.viewData)||a({viewData:t,viewParameter:n,viewType:i})}componentWillUnmount(){this.props.clearCurrentPageData()}render(){let{auxData:e,children:a,component:t,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,clientTrackingParams:d}=this.props;return(0,o.jsx)(s.Z,{auxData:e,clientTrackingParams:d,component:t,objectIdStr:n,viewData:i,viewParameter:l,viewType:r,children:a})}}function u(e){(0,i.useEffect)(()=>{(0,n.Z)("PageView","/app/www/analytics/PageView.tsx")},[]);let{setViewContextData:a,clearViewContextData:t}=(0,l.A$)();return(0,o.jsx)(d,{...e,clearCurrentPageData:t,setCurrentPageData:a})}},706753:function(e,a,t){t.d(a,{Z:()=>r});var n=t(667294),i=t(521009),l=t(941404);function r(e){let{auxData:a,clientTrackingParams:t,children:r,component:s,element:o,objectIdStr:d,viewData:u,viewParameter:c,viewType:p}=e,g=(0,i.Z)(),m=JSON.stringify(a),h=JSON.stringify(u);return(0,n.useEffect)(()=>{(({viewType:e,viewParameter:a,viewData:t,auxData:n,objectIdStr:i,component:r,clientTrackingParams:s,element:o},d)=>{let u,c=Object.keys(u={event_type:13,view_type:e,view_parameter:a,view_data:t,aux_data:n,object_id_str:i,component:r,clientTrackingParams:s,element:o}).reduce((e,a)=>(void 0===u[a]&&delete e[a],e),{...u});-1===Object.keys(c).indexOf("view_type")&&(0,l.My)("mweb.logging.null_view_type"),d(c)})(e,g)},[g,m,t,s,o,d,h,c,p]),n.Children.only(r)}},852286:function(e,a,t){t.d(a,{Z:()=>at});var n,i,l,r,s,o,d,u,c,p,g,m=t(281098),h=t(667294);t(167912);var y=t(20256),f=t(355940),_=t(28427),x=t(801082),v=t(19585),S=t(900675),w=t(444185),k=t(634737),b=t(984126),P=t(825332),F=t(583270),C=t(258193),R=t(642407),I=t(728994),T=t(378888),j=t(144633),E=t(74678),Z=t(330510),D=t(241646),M=t(980787),K=t(390843),L=t(163404),A=t(785893);function $({arrowType:e,viewParameter:a,viewType:t}){(0,h.useEffect)(()=>{(0,m.Z)("FlashlightBackButton","/app/common/react/components/discover/Flashlight/FlashlightBackButton.tsx")},[]);let n=(0,v.ZP)(),i=(0,P.s0)(),l=(0,P.TH)(),{previous:r}=(0,K.ou)(),{logContextEvent:s}=(0,M.u)(),o=(0,L.Z)(l.pathname);return(0,A.jsx)(y.xu,{"data-test-id":"go-back-button",children:(0,A.jsx)(y.hU,{accessibilityLabel:n._('Go back', 'Accessible icon for close button', 'Accessible icon for close button'),icon:e??"directional-arrow-left",iconColor:"darkGray",onClick:()=>{if(s({event_type:101,view_type:t,element:34,view_parameter:a}),0===r.length)return void i(`/pin/${o}/`,{replace:!0});i(-1)}})})}var O=t(37326),B=t(816358),N=t(645435);function z({isProductPage:e,title:a,viewParameter:t,viewType:n}){(0,h.useEffect)(()=>{(0,m.Z)("RelatedProductsHeader","/app/common/react/components/shopping/RelatedProducts/RelatedProductsHeader.tsx")},[]);let i=(0,h.useRef)(null);return(0,h.useEffect)(()=>(i.current&&B.Z.addObstruction("top",i.current),()=>{i.current&&B.Z.removeObstruction("top",i.current)})),(0,A.jsx)(N.Z,{position:e?"sticky":"fixed",shouldShowShadow:!0,children:(0,A.jsxs)(y.xu,{color:"default",dangerouslySetInlineStyle:{__style:{paddingBottom:"12px"}},display:"flex",justifyContent:"center",children:[(0,A.jsx)(y.xu,{alignItems:"center",display:"flex",height:48,left:!0,marginStart:5,position:"absolute",right:!0,width:48,children:(0,A.jsx)($,{arrowType:a?"directional-arrow-left":"cancel",viewParameter:t,viewType:n})}),(0,A.jsx)(y.xu,{ref:i,alignItems:"center",color:"default","data-test-id":"related-products-header",display:"flex",height:48,children:(0,A.jsx)(O.Z,{title:a})})]})})}var U=t(527895),W=t(761578),H=t(956077),V=t(341742),G=t(271910);function Y({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,isSelected:n,label:i,onTap:l,ref:r,selectedPillColor:s}){(0,h.useEffect)(()=>{(0,m.Z)("DescriptorPill","/app/www/Descriptors/DescriptorPill.tsx")},[]);let[o,d]=(0,h.useState)(e);return(0,h.useEffect)(()=>{d(n?s:e)},[n,s,e]),(0,A.jsx)(y.iP,{onMouseDown:()=>d(t),onMouseEnter:()=>{n||d(a)},onMouseLeave:()=>{n||d(e)},onTap:l,rounding:4,tapStyle:"compress",children:(0,A.jsx)(y.xu,{ref:r,dangerouslySetInlineStyle:{__style:{background:o,backdropFilter:"blur(80px)",userSelect:"none"}},"data-test-id":`descriptor-pill-${i}`,paddingX:4,paddingY:2,rounding:4,children:(0,A.jsx)(y.kC,{alignItems:"center",minHeight:32,children:(0,A.jsx)(y.mg,{color:n?"light":"dark",overflow:"noWrap",children:i})})})})}let X=({showBackArrow:e,showFwdArrow:a,handleClickBack:t,handleClickForward:n})=>{(0,h.useEffect)(()=>{(0,m.Z)("DescriptorsNavigation","/app/www/Descriptors/DescriptorsNavigation.tsx")},[]);let i=(0,v.ZP)();return(0,A.jsxs)(y.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"descriptors-navigation-arrows",display:"flex",justifyContent:"between",left:!0,position:"absolute",right:!0,top:!0,children:[(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginStart:2,children:e&&(0,A.jsx)(y.hU,{accessibilityLabel:i._('Back', 'descriptor.navArrow.back', 'Accessibility label for a button that navigates back to previous search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-back-button",icon:"arrow-back",onClick:t,size:"md"})}),(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"auto"}},marginEnd:2,children:a&&(0,A.jsx)(y.hU,{accessibilityLabel:i._('Forward', 'descriptor.navArrow.forward', 'Accessibility label for a button that navigates forward to see more search guides'),bgColor:"washLight",dataTestId:"descriptor-bar-forward-button",icon:"arrow-forward",onClick:n,size:"md"})})]})};var q=t(15667);let Q=(void 0!==n||(n=t(500698)).hash&&"9d15639e8d9dd61426917dc218fbb3a6"!==n.hash&&console.error("The definition of 'Descriptors_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function J({pressedPillColor:e,defaultPillColor:a,descriptorModules:t,hoveredPillColor:n,pinKey:i,selectedPillColor:l,isWebImageSearchRedesign:r}){(0,h.useEffect)(()=>{(0,m.Z)("Descriptors","/app/www/Descriptors/Descriptors.tsx")},[]);let[s,o]=(0,h.useState)(),[d,u]=(0,h.useState)(0),c=(0,P.s0)(),{search:p}=(0,P.TH)(),{barContainer:g,clientWidth:f,centerModules:x,offset:v,showBackArrow:S,showFwdArrow:w,handleClickForward:k,handleClickBack:b,onFocus:F,onMouseDown:C,scrollToPillByOffset:R}=(e=>{let a=(0,h.useRef)(null),{isRTL:t}=(0,q.B)(),n=(0,h.useRef)(!1),[i,l]=(0,h.useState)(0),[r,s]=(0,h.useState)(0),[o,d]=(0,h.useState)(!1),[u,c]=(0,h.useState)(!1),{current:p}=a,{clientWidth:g=0,scrollWidth:m=0}=p??{},y=g||0,f=!!p&&y>=(m||0),_=e.length;(0,h.useEffect)(()=>{let e=p?.scrollWidth||0,a=0;Array.from(p?.children||[]).slice(0,i).forEach(e=>{a+=e.offsetWidth||0}),s(a=Math.min(a,e-g+8));let t=e-a,n=y>=e;n&&0!==i&&l(0),d(i>0&&!n),c(t>y&&i<_&&!n)},[p,i,_,y,t,g]);let x=(0,h.useCallback)(e=>{if(!p)return;let a=Array.from(p.children);if(e<0||e>=a.length)return;let t=0;a.slice(0,e).forEach(e=>{t+=e?.offsetWidth??0});let n=a[e]?.offsetWidth??0;if(t<r){s(t),l(e);return}if(t+n>r+g){s(t+n-g),l(e);return}l(e)},[p,r,g]),v=(0,h.useCallback)((e,a)=>{let t=e.current;if(!t||a<0||a>=t.length)return;let n=Array.from({length:a}).reduce((e,a,n)=>e+(t[n]?.offsetWidth??0),0),i=n+(t[a]?.offsetWidth??0);if(n>=r&&i<=r+g)return;let o=n<r?n:i-g;s(Math.max(0,Math.min(o,Math.max(0,m-g+8)))),l(Array.from({length:t.length}).reduce((e,a,n)=>{let{foundIndex:i,accWidth:l}=e;if(-1!==i)return e;let r=l+(t[n]?.offsetWidth??0);return{foundIndex:l>=o?n:-1,accWidth:r}},{foundIndex:-1,accWidth:0}).foundIndex)},[r,g,m]),S=(0,h.useCallback)(e=>{if("Tab"!==e.key)return;let a=Array.from(p?.children||[]),t=document.activeElement,n=a.findIndex(e=>e.contains(t));-1!==n&&(!e.shiftKey&&n<a.length-1?x(n+1):e.shiftKey&&n>0&&x(n-1))},[p,x]);return(0,h.useEffect)(()=>{if(p)return p.addEventListener("keydown",S,!0),()=>{p.removeEventListener("keydown",S,!0)}},[p,S]),{barContainer:a,centerModules:f,clientWidth:g,offset:r,showBackArrow:o,showFwdArrow:u,onFocus:()=>{n.current||l(i)},index:i,setIndex:l,handleClickForward:()=>{i+2<_?l(i+2):l(_-2)},handleClickBack:()=>{i-2>=0?l(i-2):l(0)},onMouseDown:()=>{n.current=!0},scrollToPillByOffset:v}})(t),I=(0,_.Z)(Q,i),{logContextEvent:j}=(0,M.u)(),{descriptorsRefs:E}=((e,a,t,n,i)=>{let{logContextEvent:l}=(0,M.u)(),r=(0,h.useRef)([]),s=(0,h.useRef)([]);return(0,h.useEffect)(()=>{let o=0,d=r.current.map((n,i)=>{let l=n?.offsetWidth||0,r=o,s=o+l;o+=l+4;let{auxData:d}=t[i]||{auxData:{}},u=e+a,c=r+16>e&&r<u,p=s>e&&s-16<u;return{moduleId:d?.moduleId||"",isVisible:c||p}});d.forEach((e,a)=>{let t=s.current[a];if((!t||!1===t.isVisible)&&e.isVisible){let{auxData:e}=i||{};l({event_type:9993,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:n||"",descriptor:e?.query}})}}),s.current=d},[r,e,a,t,l,n,i,s]),{descriptorsRefs:r}})(v,f,t,I.imageSignature||"",s);(0,V.Z)(()=>{if(void 0===s){let e=t.findIndex(e=>{let{display:a}=e,{isSelected:t}=a||{isSelected:!1};return t}),{hybrid_search_param:a}=(0,T.mB)(p);-1!==e&&a&&(o(t[e]),R(E,e-1))}}),(0,h.useEffect)(()=>{u(r?(e=>{if(!e)return 0;let a=e.getBoundingClientRect(),t=window.innerHeight;return a.bottom>t?a.bottom-t:0})(g.current):0)},[g,r]);let Z=e=>{let{id:a}=e,{id:t}=s||{};return null!=a&&t===a};return(0,A.jsx)(G.q,{children:({hovered:i,onMouseEnter:r,onMouseLeave:u})=>(0,A.jsxs)(y.xu,{dangerouslySetInlineStyle:{__style:{bottom:d}},"data-test-id":"scrollable-descriptor-bar-root",left:!0,onMouseEnter:r,onMouseLeave:u,overflow:"hidden",position:"absolute",right:!0,children:[(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{left:`-${v}px`,transition:"left 0.3s, right 0.3s"}},position:"relative",children:(0,A.jsx)(y.xu,{ref:g,display:"flex",justifyContent:x?"center":void 0,marginStart:2,paddingY:2,children:t.map((t,i)=>{let{action:r,display:s}=t,{feedUrl:d}=r||{};if(null==d)return null;let{displayText:u}=s||{};return(0,A.jsx)(y.xu,{marginEnd:1,onFocus:F,onMouseDown:C,children:(0,A.jsx)(Y,{ref:e=>{E.current[i]=e},defaultPillColor:a,hoveredPillColor:n,isSelected:Z(t),label:u||"",onTap:()=>((e,a)=>{let t=Z(e),{action:n}=e,{feedUrl:i}=n||{};if(i)if(t){let e=i,{surfaceType:a}=(0,T.mB)(p);a&&(e=i.replace(RegExp(`^(.*surfaceType=${a}).*$`),"$1")),c(e??"",{replace:!0}),o(void 0)}else{let{surfaceType:t}=(0,T.mB)(p),n=i;t&&(n=i.replace(/(surfaceType=)[^&]*/,`$1${t}`)),c(n??"",{replace:!0}),R(E,a),o(e)}let{auxData:l}=e;j({event_type:102,view_type:72,view_parameter:3050,component:14047,aux_data:{image_signature:I.imageSignature||"",descriptor:l?.query}})})(t,i),pressedPillColor:e,selectedPillColor:l})},`descriptors-module-${t.id||i}`)})})}),i&&(0,A.jsx)(X,{handleClickBack:()=>{b();let{auxData:e}=s||{};j({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:I.imageSignature||"",descriptor:e?.query}})},handleClickForward:()=>{k();let{auxData:e}=s||{};j({event_type:108,view_type:72,view_parameter:3050,component:14046,aux_data:{image_signature:I.imageSignature||"",descriptor:e?.query}})},showBackArrow:S,showFwdArrow:w})]})})}var ee=t(790314);function ea(e){return(0,h.useMemo)(()=>{let[a,t]=(0,ee.Rn)({hexColor:e||"#FFFFFF",saturationMultiplier:3,brightnessMultiplier:1.6,minSaturationClamp:.15,mixVal:.3,minBrightnessClamp:0}),n=`rgba(${t[0]}, ${t[1]}, ${t[2]}, 0.8)`,i=`rgba(${a[0]}, ${a[1]}, ${a[2]}, 0.8)`,l=(0,ee.e3)((0,ee.rk)((0,ee.t7)("rgba(117, 117, 112, 0.2)"),(0,ee.t7)(n))),r=(0,ee.e3)((0,ee.rk)((0,ee.t7)("rgba(117, 117, 112, 0.4)"),(0,ee.t7)(n)));return{defaultColor:n,selectedColor:i,hoveredColor:l,pressedColor:r}},[e])}var et=t(430635);function en({defaultPillColor:e,hoveredPillColor:a,pressedPillColor:t,viewParameter:n,viewType:i}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchCancelButton","/app/www/VisualSearch/VisualSearchCancelButton.tsx")},[]);let l=(0,v.ZP)(),r=(0,P.s0)(),s=(0,et.Z)(),{active:o,focused:d,hovered:u,onBlur:c,onFocus:p,onMouseDown:g,onMouseEnter:f,onMouseLeave:_,onMouseUp:x}=(0,G.Z)(),{pinId:S}=(0,k.Z)(s.params.id||""),{previous:w}=(0,K.ou)(),{logContextEvent:b}=(0,M.u)();return(0,A.jsx)(y.xu,{"data-test-id":"go-back-button",children:(0,A.jsx)(y.iP,{onBlur:c,onFocus:p,onMouseDown:g,onMouseEnter:f,onMouseLeave:_,onMouseUp:x,onTap:()=>{if(b({event_type:101,view_type:i,element:34,view_parameter:n}),0===w.length)return void r(`/pin/${S}/`,{replace:!0});r(-1)},tapStyle:"compress",children:(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{background:o?t:d||u?a:e,backdropFilter:"blur(80px)"}},padding:3,rounding:4,children:(0,A.jsx)(y.JO,{accessibilityLabel:l._('Go back', 'imageSearch.cancelButton', 'Cancel button for going back to the Pin page'),color:"default",icon:"cancel",size:24})})})})}var ei=t(442212),el=t(675973),er=t(359829),es=t(870358),eo=t(369416),ed=t(556872),eu=t(665290),ec=t(281503);let ep=Math.ceil(40),eg=ep+1;function em({isHidden:e,isObjectLevelCrop:a,isSelected:t,maskHeight:n,maskId:i,maskUrl:l,maskWidth:r,maskX:s,maskY:o}){(0,h.useEffect)(()=>{(0,m.Z)("CutoutGlow","/app/www/Cutouts/CutoutGlow.tsx")},[]);let{checkExperiment:d}=(0,el.Z)(),u="enabled_once"===d("web_cutout_glow").group,{insetIntensity:c,debugMode:p,showHiddenCutoutsinDebug:g}=function(e){let a=e.split("_");return{insetIntensity:""===a[0]||Number.isNaN(Number(a[0]))?void 0:Number(a[0]),debugMode:a.includes("debug"),showHiddenCutoutsinDebug:a.includes("all")}}(d("web_cutout_glow_inset").group),f=`glow-sweep-${i}`,_=Math.round(.35*n),x=n/2+_/2,v=a?.25:.5,{svgElement:S,maskStyle:w}=(0,ec.Z)({debugMode:p,insetIntensity:c,kind:"glow",maskHeight:n,maskId:i,maskUrl:l,maskWidth:r});return(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{left:s,top:o,...w,visibility:t?"hidden":"visible"}},"data-test-id":"cutout-item",height:n,id:eu.Ii,position:"absolute",width:r,children:(!e||g)&&(0,A.jsxs)(h.Fragment,{children:[S,(0,A.jsx)(eo.Z,{unsafeCSS:`
          @keyframes ${f} {
            0%                    { mask-position: 0 -${x}px; opacity: ${v}; }
            ${ep}% { mask-position: 0  ${x}px; opacity: ${v}; }
            ${eg}%      { mask-position: 0  ${x}px; opacity: 0; }
            100%                  { mask-position: 0 -${x}px; opacity: 0; }
          }`}),(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{pointerEvents:"none",animation:u?`${f} 5s linear forwards`:`${f} 5s linear infinite`,animationDelay:"1s",maskImage:`
              radial-gradient(
                ellipse ${4*_}px ${_}px at center,
                white 0%,
                white 15%,
                rgba(255, 255, 255, 0.9) 30%,
                rgba(255, 255, 255, 0.7) 45%,
                rgba(255, 255, 255, 0.5) 55%,
                rgba(255, 255, 255, 0.3) 65%,
                rgba(255, 255, 255, 0.15) 72%,
                rgba(255, 255, 255, 0.06) 80%,
                rgba(255, 255, 255, 0.01) 90%,
                transparent 100%
              )`,maskPosition:`0 -${x}px`,maskSize:"100% 100%",maskRepeat:"no-repeat"}},"data-test-id":"cutout-glow-oval",height:"100%",opacity:0,width:"100%",children:(0,A.jsx)(y.Ee,{alt:"cutout-glow-background-image",color:"white",fetchPriority:"high",fit:"cover",loading:"eager",naturalHeight:n,naturalWidth:r,role:"presentation",src:a?void 0:"https://s.pinimg.com/webapp/cutout-glow-background-c870a580.jpg"})})]})})}var eh=t(854146);function ey({isHovered:e,isObjectLevelCrop:a,isPinLevelCrop:t,isSelected:n,mask:i,pinImageHeight:l,pinImageUrl:r,pinImageWidth:s,viewParameter:o,viewType:d}){(0,h.useEffect)(()=>{(0,m.Z)("CutoutObject","/app/www/Cutouts/CutoutObject.tsx")},[]);let{logContextEvent:u}=(0,M.u)(),{id:c,isHidden:p,maskHeight:g,maskUrl:y,maskWidth:f,maskX:_,maskY:x}=i;return(0,V.Z)(()=>{p||u({event_type:120,element:14154,view_parameter:o,view_type:d,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}})}),(0,A.jsxs)(h.Fragment,{children:[(0,A.jsx)(eh.Z,{imageHeight:l,imageUrl:r,imageWidth:s,isHovered:e,isPinLevelCrop:t,isSelected:n,maskHeight:g,maskId:c,maskUrl:y,maskWidth:f,maskX:_,maskY:x}),(0,A.jsx)(em,{isHidden:p,isObjectLevelCrop:a,isSelected:n,maskHeight:g,maskId:c,maskUrl:y,maskWidth:f,maskX:_,maskY:x})]})}let ef=(e,a,t)=>{let{maskX:n,maskY:i,maskWidth:l,maskHeight:r}=t;return e>=n&&e<=n+l&&a>=i&&a<=i+r},e_=(e,a,t)=>{if(a<0||t<0||a>=e.canvas.width||t>=e.canvas.height)return!1;try{let n=e.getImageData(a,t,1,1).data[0];return void 0!==n&&n>0}catch{return!1}},ex=e=>{let{id:a,mask_image:t,mask_bounds:n}=e;if(!a||!t||!n||2!==n.length)return!1;let[i,l]=n;if(!i||!l||2!==i.length||2!==l.length)return!1;let[r,s]=i,[o,d]=l;return[r,s,o,d].every(e=>"number"==typeof e&&!Number.isNaN(e))};function ev({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:t,imageContainerY:n,pinImageHeight:i,pinImageUrl:l,pinImageWidth:r,selectedCutoutIndex:s,setHoveredCutoutIndex:o,setSelectedCutoutIndex:d,trafficSource:u,viewParameter:c,viewType:p}){(0,h.useEffect)(()=>{(0,m.Z)("CutoutObjects","/app/www/Cutouts/CutoutObjects.tsx")},[]);let{logContextEvent:g}=(0,M.u)(),f=(0,P.TH)(),_=(0,P.s0)(),x=(0,h.useRef)(null),[v,S]=(0,h.useState)(!1),{w,h:k,cropSource:b}=(0,T.mB)(f.search),F=(0,h.useMemo)(()=>Number(w)===r&&Number(k)===i||void 0===w&&void 0===k,[k,i,r,w]),C=(0,h.useMemo)(()=>9===Number(b),[b]),{cutoutContexts:R,maskData:I}=function(e,a,t){let[n,i]=(0,h.useState)([]),[l,r]=(0,h.useState)([]),[s,o]=(0,h.useState)(!1);return(0,h.useEffect)(()=>{let{maskData:n,urls:l}=e.reduce((e,n)=>{let i=((e,a,t)=>{if(!ex(e))return null;let{id:n,mask_image:i,mask_bounds:l,is_hidden:r}=e,[s,o]=l[0],[d,u]=l[1],c=(e=>{try{let a=atob(e),t=Uint8Array.from(a,e=>e.charCodeAt(0)),n=new Blob([t],{type:"image/png"});return URL.createObjectURL(n)}catch{return null}})(i);return c?{maskData:{id:n,isHidden:!!r,maskHeight:u*t,maskHeightRatio:u,maskUrl:c,maskWidth:d*a,maskWidthRatio:d,maskX:s*a,maskXRatio:s,maskY:o*t,maskYRatio:o},maskUrl:c}:null})(n,a,t);return i&&(e.maskData.push(i.maskData),e.urls.push(i.maskUrl)),e},{maskData:[],urls:[]});if(r(n),0===n.length)return i([]),o(!1),()=>l.forEach(e=>URL.revokeObjectURL(e));let s=!1;return o(!0),(async()=>{let e=n.map(async e=>{let a=document.createElement("canvas"),t=a.getContext("2d",{willReadFrequently:!0});if(!t)return null;let{maskWidth:n,maskHeight:i}=e;a.width=n,a.height=i;try{let a=new Image;return a.crossOrigin="anonymous",new Promise(l=>{a.onload=()=>{if(s)return void l(null);t.drawImage(a,0,0,n,i),l(t)},a.onerror=()=>l(null),a.src=e.maskUrl})}catch{return null}}),a=await Promise.all(e);s||(i(a),o(!1))})(),()=>{s=!0,l.forEach(e=>URL.revokeObjectURL(e))}},[e,a,t]),{cutoutContexts:n,maskData:l,isLoading:s}}(e,r,i),j=function({maskData:e,cutoutContexts:a,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:i,viewParameter:l,viewType:r}){let{logContextEvent:s}=(0,M.u)(),{checkExperiment:o}=(0,el.Z)(),{anyEnabled:d,group:u}=o("web_cutout_hit_detection_cache"),c="control"===u?1:"employees"===u?5:Number(u.split("_")[1]||5),p=(0,h.useRef)(new Map);(0,h.useEffect)(()=>{p.current.clear()},[e]);let g=(0,h.useCallback)((e,a)=>{e!==a&&(i(e),null!==e&&s({event_type:105,element:14154,view_parameter:l,view_type:r,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}))},[i,s,l,r]);return(0,h.useCallback)((i,l,r)=>{let s=d?`${Math.round(i.clientX/c)*c},${Math.round(i.clientY/c)*c}`:"";if(d&&p.current.has(s))return void g(p.current.get(s)??null,l);let o=i.clientX-t,u=i.clientY-n;for(let t=e.length-1;t>=0;t-=1){let n=e[t],i=a[t];if(i&&n&&t!==r&&ef(o,u,n)&&e_(i,o-n.maskX,u-n.maskY)){d&&p.current.set(s,t),g(t,l);return}}d&&p.current.set(s,null),g(null,l)},[d,a,t,n,e,c,g])}({maskData:I,cutoutContexts:R,imageContainerX:t,imageContainerY:n,setHoveredCutoutIndex:o,viewParameter:c,viewType:p}),E=(0,h.useCallback)(()=>S(!1),[]),Z=(0,h.useCallback)(e=>{(e.movementX||e.movementY)&&S(!0),0===e.buttons?j(e,a,s):o?.(null)},[j,a,s,o]),D=(0,h.useCallback)(e=>j(e,a,s),[j,a,s]),K=(0,h.useCallback)(()=>o(null),[o]),L=(0,h.useCallback)(()=>{if(v||null===a)return void S(!1);if(o(null),d(a),!I[a])return;let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:l}=I[a],s=(0,ed.Z)({cropArea:{x:e,y:t,w:n,h:l},scaledWidth:r,scaledHeight:i}),m=(0,es.Z)({cropArea:s,cropSource:9,trafficSource:u});window.location.search!==m&&(g({event_type:101,element:14154,view_parameter:c,view_type:p,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}),_(`${window.location.pathname}${m}`,{replace:!0}))},[v,_,a,g,I,i,r,o,d,u,c,p]);return(0,h.useEffect)(()=>{let e=x.current;if(e)return e.addEventListener("mousedown",E),e.addEventListener("mousemove",Z),e.addEventListener("mouseup",D),e.addEventListener("mouseleave",K),e.addEventListener("click",L),()=>{e.removeEventListener("mousedown",E),e.removeEventListener("mousemove",Z),e.removeEventListener("mouseup",D),e.removeEventListener("mouseleave",K),e.removeEventListener("click",L)}},[E,Z,D,K,L]),(0,A.jsxs)(y.xu,{ref:x,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":I.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,A.jsx)(eo.Z,{unsafeCSS:eu.iF}),I.map((e,t)=>(0,A.jsx)(ey,{isHovered:a===t,isObjectLevelCrop:C,isPinLevelCrop:F,isSelected:s===t,mask:e,pinImageHeight:i,pinImageUrl:l,pinImageWidth:r,viewParameter:c,viewType:p},e.id))]})}var eS=t(739067),ew=t(378547);function ek({bitmapMasks:e,hoveredCutoutIndex:a,imageContainerX:n,imageContainerY:i,pinImageHovered:l,pinImageHeight:r,pinImageUrl:s,pinImageWidth:o,selectedCutoutIndex:d,setHoveredCutoutIndex:u,setSelectedCutoutIndex:c,trafficSource:p,viewParameter:g,viewType:f}){(0,h.useEffect)(()=>{(0,m.Z)("StelaCutouts","/app/www/Cutouts/StelaCutouts.tsx")},[]);let _=(0,P.TH)(),{logContextEvent:x}=(0,M.u)(),v=(0,P.s0)(),S=(0,h.useRef)(null),[w,k]=(0,h.useState)(!1),[b,F]=(0,h.useState)([]),[C,R]=(0,h.useState)(!1),[I,j]=(0,h.useState)(!1),{w:E,h:Z}=(0,T.mB)(_.search),D=(0,h.useMemo)(()=>Number(E)===o&&Number(Z)===r||void 0===E&&void 0===Z,[Z,r,o,E]),K=(0,h.useMemo)(()=>({commerce_data:JSON.stringify({pin_has_cutout:!0})}),[]);(0,h.useEffect)(()=>{if(!e)return;let a=[];async function n({id:e,isHidden:n,maskHeightRatio:i,maskImage:l,maskWidthRatio:r,maskXRatio:s,maskYRatio:o,pinImageHeight:d,pinImageWidth:u}){let{ContourTracer:c,initializeWasm:p}=await t.e("95563").then(t.bind(t,193386));await p();let g=new c,m=atob(l),h=new Blob([Uint8Array.from(m,e=>e.charCodeAt(0))],{type:"image/png"}),y=await createImageBitmap(h),f=g.trace(y,{useAlpha:!1,threshold:80}),_=URL.createObjectURL(h);return a.push(_),{contours:f,contourXRatio:u*r/y.width,contourYRatio:d*i/y.height,id:e,isHidden:n,maskHeightRatio:i,maskUrl:_,maskWidthRatio:r,maskXRatio:s,maskYRatio:o}}let i=[];return e.forEach(e=>{let{id:a,mask_image:t,mask_bounds:l,is_hidden:s}=e,[d,u]=l?.[0]??[],[c,p]=l?.[1]??[];if(void 0!==a&&void 0!==t&&void 0!==d&&void 0!==u&&void 0!==c&&void 0!==p){let e=n({id:a,isHidden:!!s,maskHeightRatio:p,maskImage:t,maskWidthRatio:c,maskXRatio:d,maskYRatio:u,pinImageHeight:r,pinImageWidth:o});i.push(e)}}),(async()=>{F(await Promise.all(i))})(),()=>{a.forEach(e=>{URL.revokeObjectURL(e)})}},[e,r,o]);let L=(0,h.useMemo)(()=>{let e=[];return b.forEach((a,t)=>{let{contours:n}=a;n&&0!==n.length&&(e[t]=n.map(e=>{let a=e.points.map(e=>e.x),t=e.points.map(e=>e.y);return{minX:Math.min(...a),minY:Math.min(...t),maxX:Math.max(...a),maxY:Math.max(...t)}}))}),e},[b]),$=(0,h.useCallback)(e=>{let t=e.clientX-n,l=e.clientY-i;for(let e=b.length-1;e>=0;e-=1){let n=b[e];if(e===d||!n)continue;let{contours:i,contourXRatio:s,contourYRatio:c,maskXRatio:p,maskYRatio:m}=n,h=(t-p*o)/s,y=(l-m*r)/c,_=L[e];if(i.some((e,a)=>{let t=_?.[a];return t&&h>=t.minX&&h<=t.maxX&&y>=t.minY&&y<=t.maxY&&(0,eS.Z)({x:h,y:y},e.points)})){a!==e&&(u?.(e),x({event_type:105,element:14154,view_parameter:g,view_type:f,aux_data:{commerce_data:JSON.stringify({pin_has_cutout:!0})}}));return}}u?.(null)},[b,L,a,n,i,x,r,o,d,u,g,f]),O=()=>k(!1),B=e=>{(e.movementX||e.movementY)&&k(!0),0===e.buttons?$(e):u?.(null)},N=e=>{$(e)},z=()=>u?.(null),U=(0,h.useCallback)(()=>{if(w||null===a||!b[a])return void k(!1);c?.(a);let{maskXRatio:e,maskYRatio:t,maskWidthRatio:n,maskHeightRatio:i}=b[a],l=(0,ed.Z)({cropArea:{x:e,y:t,w:n,h:i},scaledWidth:o,scaledHeight:r}),s=(0,es.Z)({cropArea:l,cropSource:9,trafficSource:p});s!==window.location.search&&(x({event_type:101,element:14154,view_parameter:g,view_type:f,aux_data:K}),v(`${window.location.pathname}${s}`,{replace:!0}))},[K,b,w,v,a,x,r,o,c,p,g,f]);return((0,h.useEffect)(()=>{let e=S.current;return e&&(e.addEventListener("mousedown",O),e.addEventListener("mousemove",B),e.addEventListener("mouseup",N),e.addEventListener("mouseleave",z),e.addEventListener("click",U)),()=>{e&&(e.removeEventListener("mousedown",O),e.removeEventListener("mousemove",B),e.removeEventListener("mouseup",N),e.removeEventListener("mouseleave",z),e.removeEventListener("click",U))}}),e)?(0,A.jsxs)(y.xu,{ref:S,bottom:!0,dangerouslySetInlineStyle:{__style:{cursor:"number"==typeof a?"pointer":"auto"}},"data-bitmaps-ready":b.length>0,"data-test-id":"cutouts-container",left:!0,position:"absolute",right:!0,role:"none",top:!0,children:[(0,A.jsx)(eo.Z,{unsafeCSS:eu.iF}),b.map((e,t)=>(0,A.jsx)(ew.Z,{auxData:K,bitmapData:e,hasAnimatedCutoutsOnLand:I,hasLoggedRender:C,hoveredCutoutIndex:a,index:t,isPinLevelCrop:D,pinImageHeight:r,pinImageHovered:l,pinImageUrl:s,pinImageWidth:o,selectedCutoutIndex:d,setHasAnimatedCutoutsOnLand:j,setHasLoggedRender:R,viewParameter:g,viewType:f},e.id))]}):null}var eb=t(897448);let eP=(void 0!==i||(i=t(934209)).hash&&"fbf2d3b93402a9dd783073db316c0f92"!==i.hash&&console.error("The definition of 'VisualSearchCropper_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function eF({cropArea:e,cropSource:a,imageContainerX:t=0,imageContainerY:n=0,imageSize:i,pinKey:l,trafficSource:r,viewParameter:s,viewType:o}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchCropper","/app/www/VisualSearch/VisualSearchCropper.tsx")},[]);let{checkExperiment:d}=(0,el.Z)(),u=(0,_.Z)(eP,l),c=(0,P.s0)(),p=(0,Z.D)(),{getNormalizedPinImage:g}=(0,I.Z)({pinKey:u,maxWidth:R.Wm}),y=(0,eb.Z)({pinKey:u}),[f,x]=(0,h.useState)("none"),[v,S]=(0,h.useState)(null),[w,k]=(0,h.useState)(-1),{bitmap_masks:b}=y??{},F=(0,h.useMemo)(()=>(b??[]).filter(ex).map(e=>{let{id:a,mask_bounds:t}=e,[n,i]=t[0],[l,r]=t[1];return{x:n,y:i,w:l,h:r,id:a}}),[b]);return(0,h.useEffect)(()=>{let a=(0,E.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0});if(F&&F.length){let e=(0,er.Z)(F,a);x("cutouts"),k(e.indexToHide)}},[e,F,i.height,i.width]),(0,A.jsx)(ei.Z,{cropArea:e,cropSource:a,hoveredCutoutIndex:v,imageContainerX:t,imageContainerY:n,imageSize:i,objectDetection:f,onChange:({cropArea:e,cropSource:a})=>{if("cutouts"===f){let t=(0,E.Z)({cropArea:e,scaledHeight:i.height??0,scaledWidth:i.width??0}),{isCropAreaOnDotArea:n,indexToHide:l}=(0,er.Z)(F,t);n&&(a=9,k?.(l))}let t=window.location.search,n=(0,es.Z)({cropArea:e,cropSource:a,trafficSource:r});t!==n&&c({pathname:window.location.pathname,search:n},{replace:!0})},setHoveredCutoutIndex:S,setSelectedCutoutIndex:k,viewParameter:s,viewType:o,children:(()=>{if("cutouts"!==f||!b?.length)return null;let{pinImageWidth:e,pinImageHeight:a,pinImageUrl:i}=(()=>{if(p)return{pinImageWidth:520,pinImageHeight:520/(u?.image?.width??1)*(u?.image?.height??1),pinImageUrl:u?.image?.url??""};let{height:e,width:a,url:t}=g();return{pinImageWidth:a,pinImageHeight:e,pinImageUrl:t}})(),{anyEnabled:l}=d("web_cutout_glow");return(0,A.jsx)(l?ev:ek,{bitmapMasks:b,hoveredCutoutIndex:v,imageContainerX:t,imageContainerY:n,pinImageHeight:a,pinImageUrl:i,pinImageWidth:e,selectedCutoutIndex:w,setHoveredCutoutIndex:S,setSelectedCutoutIndex:k,trafficSource:r,viewParameter:s,viewType:o})})()})}let eC=(void 0!==l||(l=t(984110)).hash&&"727c8ab2c1c256e3b4478a36890f92d6"!==l.hash&&console.error("The definition of 'RelatedProductsImageContent_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function eR({cropArea:e,cropSource:a,description:t,descriptorModules:n,height:i,imageContainerX:l,imageContainerY:r,imageUrl:s,pinKey:o,trafficSource:d,viewParameter:u,viewType:c,width:p}){(0,h.useEffect)(()=>{(0,m.Z)("RelatedProductsImageContent","/app/common/react/components/shopping/RelatedProducts/RelatedProductsImageContent.tsx")},[]);let g=(0,Z.D)(),f=(0,_.Z)(eC,o),{defaultColor:x,selectedColor:v,hoveredColor:S,pressedColor:w}=ea(f.dominantColor),{height:k=0}=(0,W.Z)()||{},b=r+i,P=b>k,F=P?Math.min(b-64-12,k-64-12):i-64;return(0,A.jsxs)(y.xu,{"data-test-id":"flashlight-enabled-image",height:i,width:p,children:[(0,A.jsxs)(y.zd,{height:i,rounding:g?6:4,width:p,children:[(0,A.jsx)(U.Z,{_enableViewTransitions:!0,type:"image",children:(0,A.jsx)(y.Ee,{alt:t,naturalHeight:i,naturalWidth:p,onLoad:()=>{(0,H.Nx)("visualSearchMainPinImageRender")},src:s})}),(0,A.jsx)(eF,{cropArea:e,cropSource:a,imageContainerX:l,imageContainerY:r,imageSize:{height:i,width:p},pinKey:f,trafficSource:d,viewParameter:u,viewType:c}),g&&(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{insetInlineStart:0}},position:"absolute",top:!0,children:(0,A.jsx)(en,{defaultPillColor:x,hoveredPillColor:S,pressedPillColor:w,viewParameter:u,viewType:c})})]}),n&&n.length>0&&(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:F}},height:64,position:P?"fixed":"absolute",width:p,children:(0,A.jsx)(J,{defaultPillColor:x,descriptorModules:n,hoveredPillColor:S,pinKey:f,pressedPillColor:w,selectedPillColor:v})})]})}var eI=t(742235),eT=t(780879),ej=t(721465),eE=t(288910);let eZ=(void 0!==r||(r=t(758809)).hash&&"20c2c7f4ff982fb93a9608faa14f3ed2"!==r.hash&&console.error("The definition of 'RelatedProductsUnifiedFeed_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r);function eD({alignStart:e,auxData:a,isFilterOpened:t,isProductOnlyFeed:n,oneBarModules:i,pinKey:l,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o}){(0,h.useEffect)(()=>{(0,m.Z)("RelatedProductsUnifiedFeed","/app/common/react/components/shopping/RelatedProducts/UnifiedFeed/RelatedProductsUnifiedFeed.tsx")},[]);let d=(0,_.Z)(eZ,l),u=!n&&i&&i.length>0,{data:c}=o,p=c?.search_identifier;return(0,A.jsxs)(h.Fragment,{children:[u&&(0,A.jsx)(y.xu,{position:"relative",zIndex:new y.Ry(1),children:(0,A.jsx)(eE.v,{children:(0,A.jsx)(eT.f,{children:(0,A.jsx)(eI.default,{oneBarModulesKey:null,oneBarModulesRest:i,paddingX:8})})})}),(0,A.jsx)(y.xu,{overflow:"hidden",children:(0,A.jsx)(ej.Z,{alignStart:e,auxData:a,isFilterOpened:t,isProductFeed:n,pinKey:d,searchId:p,viewParameter:r,viewType:s,visualSearchFlashlightUnifiedResource:o})})]})}var eM=t(449029),eK=t(140725),eL=t(93966),eA=t(123998);function e$({cropSource:e}){return{viewType:72,viewParameter:9===e?3462:3050}}var eO=t(230543),eB=t(74459);let eN=(void 0!==s||(s=t(829187)).hash&&"3a9a747c3135f426fe0cf32ca9147a5d"!==s.hash&&console.error("The definition of 'VisualSearchContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),s);function ez({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,title:s,trafficSource:o,visualSearchFlashlightUnifiedResource:d}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchContainer","/app/www/VisualSearch/VisualSearchContainer.tsx")},[]);let u=(0,_.Z)(eN,i),{getNormalizedPinImage:c}=(0,I.Z)({pinKey:u,maxWidth:R.Wm}),p=(0,P.TH)(),{width:g=0}=(0,W.Z)()||{},f=(0,eO.t)(),x=(0,eB.Z)(),{imageContainerScrollTop:v,imageContainerScrollTopForPinId:S}=(0,eM._)(),w=(0,h.useRef)(null),[k,b]=(0,h.useState)(0),[F,C]=(0,h.useState)(0),{state:T}=p||{},{internalNavigation:j=!1}=T||{},{width:E,height:Z,url:M}=c(),K=E+D.n,L=t?0:K+48,$=g-x-L-D.n,{viewType:O,viewParameter:B}=e$({cropSource:a}),N={commerce_data:JSON.stringify({is_product_only_feed:t})},U=()=>{let e=w.current;if(e){let{x:a,y:t}=e.getBoundingClientRect(),{scrollTop:n}=e;b(a),C(t-n)}};return(0,V.Z)(()=>{U(),w.current&&0!==v.current&&S.current===u.entityId&&(w.current.scrollTop=v.current)}),(0,A.jsx)(eA.Z,{objectId:l,view:O,children:(0,A.jsx)(eK.Z,{log:{aux_data:N,view_type:O,view_parameter:B},children:(0,A.jsxs)(y.xu,{"data-test-id":"related-products",children:[(0,A.jsx)(z,{isProductPage:t,title:t?s:"",viewParameter:B,viewType:O}),!t&&(0,A.jsx)(y.xu,{ref:w,bottom:!0,dangerouslySetInlineStyle:{__style:{top:f+80,left:x,right:x}},height:"inherit",marginBottom:3,marginStart:12,onScroll:()=>{U(),v.current=w.current?.scrollTop||0,S.current=u.entityId},overflow:"auto",position:"fixed",width:K,children:(0,A.jsx)(eR,{cropArea:e,cropSource:a,description:u.description??"",descriptorModules:r,height:Z,imageContainerX:k,imageContainerY:F,imageSignature:u.imageSignature||"",imageUrl:M,pinKey:u,showAnimation:!j,trafficSource:o,viewParameter:B,viewType:O,width:E})}),(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:80*!t,left:L,right:L}},paddingX:eL.jC,position:"relative",width:$,children:(0,A.jsx)(eD,{auxData:N,isProductOnlyFeed:t,oneBarModules:n,pinKey:u,viewParameter:B,viewType:O,visualSearchFlashlightUnifiedResource:d})})]})})})}var eU=t(762525),eW=t(469167),eH=t(355363),eV=t(159527),eG=t(845421),eY=t(816533),eX=t(351607),eq=t(757947),eQ=t(162903);let eJ=(void 0!==o||(o=t(172359)).hash&&"b1061aefab46af37d4c9716916386af2"!==o.hash&&console.error("The definition of 'VisualSearchCarousel_story' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o);function e0({componentType:e,hasActionCTA:a,legacyStory:t,searchIdentifier:n,storyKey:i,trafficSource:l,viewParameter:r,viewType:s}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchCarousel","/app/www/VisualSearch/VisualSearchCarousel.tsx")},[]);let o=(0,P.TH)(),d=(0,_.Z)(eJ,i),u=(0,eX.ZP)({clientTrackingParams:d?.trackingParams,componentType:e,contextLogData:{story_id:d?.storyId,story_type:d?.storyType,content_ids:d?.contentIds},impressionType:"Story",loggingId:d?.storyId,slotIndex:0,viewParameter:r,viewType:s}),c=(0,h.useCallback)(({item:e,index:t})=>{if(a&&d.objects&&t===d.objects.length-1){let a=e.images?.["236x"]?.url,t=o.pathname+"products/"+o.search;return a&&(0,A.jsx)(eq.Z,{buttonText:d.action?.text||"See more",component:14339,dataTestId:"shop-action-item-button",element:179,imageWidth:eY.Z,previewImageSrc:a,storyId:d.storyId??void 0,storyType:d.storyType,url:t,view:s,viewParameter:r})}return(0,A.jsx)(eG.r,{componentType:14339,isInDesktopCarousel:!0,pinId:e.id||"",pinImageCrop:{width:eY.Z,height:eY.Z},pinKey:null,slotIndex:t,surface:"VisualInspirationShoppingPin",trafficSource:l,viewData:{search_identifier:n},viewParameter:r,viewType:s})},[a,d.objects,d.action?.text,d.storyId,d.storyType,l,n,r,s,o.pathname,o.search]),p=t?.objects?.filter(e=>"pin"===e.type);return p&&0!==p.length?(0,A.jsx)(y.xu,{ref:u,"data-test-id":"visual-search-carousel",children:(0,A.jsx)(eQ.Z,{items:p,itemWidth:eY.Z,renderItem:c,showBorder:!0,showMarkers:!0,storyKey:d,view:s,viewParameter:r})}):null}function e1({auxData:e,isProductOnlyFeed:a,oneBarModules:t,trafficSource:n,viewParameter:i,viewType:l,visualSearchFlashlightUnifiedResource:r}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchFeed","/app/www/VisualSearch/VisualSearchFeed.tsx")},[]);let s=(0,v.ZP)(),{logContextEvent:o}=(0,M.u)(),d=(0,h.useRef)(!1),u=(0,h.useRef)(null),c=!a&&t&&t.length>0,{data:p,isFetching:g,fetchMore:f,isAtEnd:_}=r,{results:x=[],search_identifier:S}=p||{},{action:w,objects:k}=x.find(e=>"story"===e.type&&"stela_shop"===e.story_type)||{},{text:b,url:P}=w||{},F=k?.length||0,C=!!(b&&P),R=(0,eV.Z)(()=>{d.current||(o({event_type:110,view_type:l,view_parameter:i}),d.current=!0)},1e3),I=(0,h.useCallback)(({data:t,itemIdx:r})=>{if("story"===t.type)return"unified_entry_point_flashlight_header"===t.story_type?null:(0,A.jsx)(e0,{auxData:e,componentType:14339,hasActionCTA:C,legacyStory:t,searchIdentifier:S,storyKey:{type:"Legacy",data:t},trafficSource:n,viewParameter:i,viewType:l});if("pin"===t.type){let s=r+F-!!C;return(0,A.jsx)(eG.r,{auxData:e,componentType:0,pinId:t.id,pinKey:null,slotIndex:s,surface:a?"ShoppingDynamicHeightGrid":"SearchItem",trafficSource:n,viewData:{search_identifier:S},viewParameter:i,viewType:l})}return null},[e,S,n,l,i,C,F,a]),T=(0,h.useCallback)(e=>"story"!==e.type,[]);return(0,A.jsxs)(h.Fragment,{children:[c&&(0,A.jsx)(N.Z,{position:"sticky",shouldShowShadow:!0,children:(0,A.jsx)(eE.v,{children:(0,A.jsx)(eT.f,{children:(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{paddingInlineEnd:"8px"}},children:(0,A.jsx)(eI.default,{itemHeight:48,marginBottom:0,oneBarModulesKey:null,oneBarModulesRest:t,paddingBottom:12,paddingX:3})})})})}),(0,A.jsx)(y.xu,{ref:u,"data-test-id":"visual-search-feed",onScroll:R,overflow:"hidden",children:(0,A.jsx)(eH.Z,{isAtEndOfFeed:_,itemCount:x.length,children:(0,A.jsx)(eW.default,{align:a?"center":"start",getColumnSpanConfig:e=>{let a="story"===e.type&&e.display_options?.num_columns_requested;return 0===a?1/0:a||1},isFetching:g,isLoadedAccessibilityLabel:s._('Visual search results loaded', 'visualSearch.masonry.loaded.label', 'Accessibility label when masonry has finished loading'),isLoadingAccessibilityLabel:s._('Loading visual search results', 'visualSearch.masonry.loading.label', 'Accessibility label for masonry loading state'),isLoadingStateEnabled:!0,items:x,layout:"basic",loadItems:f,minCols:1,renderItem:I,scrollContainer:()=>u.current??window,virtualize:T})})})]})}let e2=(void 0!==d||(d=t(922081)).hash&&"8250aa2ed9c603023c2f2a226d0b9fbb"!==d.hash&&console.error("The definition of 'VisualSearchImageContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),d);function e5({cropArea:e,cropSource:a,descriptorModules:t,pinKey:n,trafficSource:i,viewParameter:l,viewType:r}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchImageContainer","/app/www/VisualSearch/VisualSearchImageContainer.tsx")},[]);let s=(0,eO.t)(),o=(0,eB.Z)(),{imageContainerScrollTop:d,imageContainerScrollTopForPinId:u}=(0,eM._)(),c=(0,h.useRef)(null),[p,g]=(0,h.useState)(0),[f,x]=(0,h.useState)(0),[v,S]=(0,h.useState)(0),{scrollCropperInView:w}=function({scrollContainerRef:e}){let a=(0,h.useCallback)(a=>{let t=e.current,{buttons:n,clientY:i}=a;if(!t||1!==n||!i)return;let{top:l,bottom:r}=t.getBoundingClientRect(),s=window.innerHeight-l,o=t.scrollHeight,d=Math.max(0,l+20-i),u=Math.max(0,i-(r-20));if(d>0){let e=Math.min(d,100);t.scrollTop-=e}else if(u>0&&!(o<=s)){let e=Math.min(u,100);t.scrollTop+=e}},[e]);return{scrollCropperInView:(0,h.useMemo)(()=>(0,eV.Z)(a,16),[a])}}({scrollContainerRef:c}),k=(0,_.Z)(e2,n),{defaultColor:b,selectedColor:P,hoveredColor:F,pressedColor:C}=ea(k.dominantColor),R=520/(k?.image?.width??1)*(k?.image?.height??1),I=k?.image?.url??"",T=(0,h.useCallback)(()=>(0,H.Nx)("visualSearchMainPinImageRender"),[]),{isDescriptorAvailable:j,descriptorModuleHeight:E,descriptorBottomBorderRadius:Z}=function({imageContainerRef:e,descriptorModules:a}){let t=!!a?.length,n=64*!!t;return t&&e.current?{isDescriptorAvailable:t,descriptorModuleHeight:n,descriptorBottomBorderRadius:function(e){let a=e.scrollTop,t=e.scrollHeight-e.clientHeight-a;return 24*(61<t&&t<67)}(e.current)}:{isDescriptorAvailable:t,descriptorModuleHeight:n,descriptorBottomBorderRadius:0}}({imageContainerRef:c,descriptorModules:t}),D=(0,h.useCallback)(()=>{let e=c.current;if(e){let{x:a,y:t}=e.getBoundingClientRect();g(a),x(t-e.scrollTop)}S(16*(R>=window.innerHeight-s&&!j))},[s,R,j]),M=(0,h.useCallback)(()=>{D(),d.current=c.current?.scrollTop||0,u.current=k.entityId},[D,k.entityId,d,u]);return(0,V.Z)(()=>{let e=c.current;if(!e)return;let a=d.current,t=u.current;return 0!==a&&t===k.entityId&&(e.scrollTop=a),D(),window.addEventListener("mousemove",w),()=>{window.removeEventListener("mousemove",w)}}),(0,A.jsxs)(h.Fragment,{children:[(0,A.jsx)(y.xu,{ref:c,bottom:!0,dangerouslySetInlineStyle:{__style:{top:s,insetInlineStart:o,height:`min(${R}px, calc(100vh - ${s}px))`,paddingBottom:`${v}px`}},"data-test-id":"visual-search-image-container",marginStart:4,onScroll:M,overflow:"auto",position:"fixed",width:536,children:(0,A.jsx)(y.xu,{"data-test-id":"flashlight-enabled-image",height:R+E,width:520,children:(0,A.jsxs)(y.zd,{height:R,rounding:6,width:520,children:[(0,A.jsx)(U.Z,{_enableViewTransitions:!0,type:"image",children:(0,A.jsx)(y.Ee,{alt:k.description??"",naturalHeight:R,naturalWidth:520,onLoad:T,src:I})}),(0,A.jsx)(eF,{cropArea:e,cropSource:a,imageContainerX:p,imageContainerY:f,imageSize:{height:R,width:520},pinKey:k,trafficSource:i,viewParameter:l,viewType:r})]})})}),(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:s,insetInlineStart:o}},"data-test-id":"visual-search-cancel-button-container",marginStart:6,marginTop:2,position:"fixed",children:(0,A.jsx)(en,{defaultPillColor:b,hoveredPillColor:F,pressedPillColor:C,viewParameter:l,viewType:r})}),j&&(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{top:`min(${s+R-E}px, calc(100vh - ${E}px))`,insetInlineStart:o,borderRadius:`0 0 ${Z}px ${Z}px`}},"data-test-id":"visual-search-descriptor-container",height:E,marginStart:4,overflow:"hidden",position:"fixed",width:520,children:(0,A.jsx)(J,{defaultPillColor:b,descriptorModules:t??[],hoveredPillColor:F,isWebImageSearchRedesign:!0,pinKey:k,pressedPillColor:C,selectedPillColor:P})}),(0,A.jsx)(y.xu,{dangerouslySetInlineStyle:{__style:{boxSizing:"content-box"}},"data-test-id":"visual-search-image-container-placeholder",height:1,marginStart:4,minWidth:536})]})}let e6=(void 0!==u||(u=t(331921)).hash&&"3c3f391c3bf9eec79c18ed9a3fe63800"!==u.hash&&console.error("The definition of 'VisualSearchLayout_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),u);function e3({cropArea:e,cropSource:a,isProductPage:t,oneBarModules:n,pinKey:i,searchId:l,descriptorModules:r,trafficSource:s,visualSearchFlashlightUnifiedResource:o}){(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchLayout","/app/www/VisualSearch/VisualSearchLayout.tsx")},[]);let d=(0,_.Z)(e6,i),u=(0,v.ZP)(),c=u._('Shop similar', 'visualSearch.productPage.header', 'Shop similar visual searched items.'),{viewType:p,viewParameter:g}=e$({cropSource:a}),f={commerce_data:JSON.stringify({is_product_only_feed:t})};return(0,A.jsx)(eA.Z,{objectId:l,view:p,children:(0,A.jsxs)(eK.Z,{log:{aux_data:f,view_type:p,view_parameter:g},children:[t?(0,A.jsx)(z,{isProductPage:!0,title:c,viewParameter:g,viewType:p}):(0,A.jsx)(eU.Z,{text:u._('Image Search Page', 'imageSearch.accessibilityHiddenHeading', 'Accessibility label for image search page')}),(0,A.jsxs)(y.kC,{children:[!t&&(0,A.jsx)(e5,{cropArea:e,cropSource:a,descriptorModules:r,pinKey:d,trafficSource:s,viewParameter:g,viewType:p}),(0,A.jsx)(y.kC.Item,{flex:"grow",children:(0,A.jsx)(e1,{auxData:f,isProductOnlyFeed:t,oneBarModules:n,trafficSource:s,viewParameter:g,viewType:p,visualSearchFlashlightUnifiedResource:o})})]})]})})}let e4=(void 0!==c||(c=t(553593)).hash&&"ece11b62e2de551b92d24a2389316249"!==c.hash&&console.error("The definition of 'VisualSearchPageWithPinData_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),c);function e8({pinKey:e}){let a,t,n=(0,P.TH)(),i=(0,_.Z)(e4,e),l=(0,Z.D)(),{getNormalizedPinImage:r}=(0,I.Z)({pinKey:i,maxWidth:l?520:R.Wm}),{cropSource:s,entrypoint:o,full_feed_title:d="",filters:u,hybrid_search_param:c,journey_depth:p,search_query:g,source_module_id:m,selected_descriptors:y,requestParams:f,rs:x}=(0,T.mB)(n.search);if(l)t=520/(i?.image?.width??1)*(i?.image?.height??1),a=520;else{let{height:e,width:n}=r();t=e,a=n}let v=(0,h.useMemo)(()=>(0,F.Z)(n,a,t)??{x:0,y:0,w:a,h:t},[n,a,t]),S=(0,j.Z)(Number(s))||5,w=n.pathname.includes("/products"),{searchId:k,visualSearchFlashlightUnifiedResource:b,oneBarModules:D,descriptorModules:M}=(0,C.Z)({resourceOptions:{crop:(0,E.Z)({cropArea:v,scaledWidth:a,scaledHeight:t}),crop_source:S,entry_source:w?"shopping":"flashlight",entrypoint:o||w&&"feed_module"||null,field_set_key:"shopping_grid_item",image_signature:i.imageSignature||void 0,is_shopping:w,pin_id:i.entityId,request_params:f,source:x,filters:u,hybrid_search_param:c,selected_descriptors:y,journey_depth:parseInt(p,10)||void 0,search_query:g,source_module_id:m}});return i?(0,A.jsx)(l?e3:ez,{cropArea:v,cropSource:S,descriptorModules:M,isProductPage:w,oneBarModules:D,pinKey:i,searchId:k,title:d,trafficSource:x,visualSearchFlashlightUnifiedResource:b}):null}function e7({pinKey:e}){return(0,h.useEffect)(()=>{(0,m.Z)("VisualSearchPageWithPinData","/app/www/VisualSearch/VisualSearchPageWithPinData.tsx")},[]),(0,A.jsx)(Z.h,{children:(0,A.jsx)(e8,{pinKey:e})})}let e9=(void 0!==p||(p=t(55575)).hash&&"0f7b98a1f02dbf8528df0452aa26efd4"!==p.hash&&console.error("The definition of 'RelatedProductsPageQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),p),ae=(void 0!==g||(g=t(376985)).hash&&"91d05676e413b7b47653c2f8fa609093"!==g.hash&&console.error("The definition of 'RelatedProductsPage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),g);function aa({pinId:e,relatedProductsDataRef:a}){let t=(0,v.ZP)(),n=(0,x.Z)({strategy:"Legacy",query:e9,variables:{pinId:e},useGetLegacyData:()=>{let{data:e}=(0,S.Z)(a);return e}}),i=n?.v3GetPinQuery?.__typename==="V3GetPin"?n.v3GetPinQuery.data:null,l=(0,_.Z)(ae,i);return(0,A.jsx)(h.Suspense,{fallback:(0,A.jsx)(y.xH,{accessibilityLabel:t._('Loading Pin data', 'RelatedProductsPage.loadingPinData', 'accessibility label for pin loading spinner'),show:!0}),children:l&&(0,A.jsx)(e7,{pinKey:l})})}function at(){(0,h.useEffect)(()=>{(0,m.Z)("RelatedProductsPage","/app/www/pages/authDesktop/RelatedProductsPage.tsx")},[]);let e=(0,et.Z)(),{pinId:a}=(0,k.Z)(e.params.id||""),{ref:t}=(0,w.Z)({name:"PinResource",options:{id:a,field_set_key:"detailed"}});return(0,A.jsx)(f.Z,{name:"RelatedProductsPage_RelatedProductsPageWrapper",children:(0,A.jsx)(h.Suspense,{fallback:(0,A.jsx)(b.Z,{}),children:(0,A.jsx)(aa,{pinId:a,relatedProductsDataRef:t})})})}},474147:function(e,a,t){t.d(a,{J:()=>m,Z:()=>_});var n=t(636208),i=t(35831),l=t(477588),r=t(356299),s=t(388023),o=t(428725),d=t(696323);let u=new Set(["PinResource","RepinResource"]),c={ApiResource:e=>e?.url==="/v3/orientation/nux_creator_recommendations/"?"nux-creator-recommendations":e?.url==="/v3/users/me/interests/"?`recommended-interests:${e.data?.blend_type}`:e?.url===`/v3/usecases/${e.data?.use_case_id}/feed/`?"useCaseFeed":e?.url===`/v3/boards/${e.data?.board_id}/automagical/pins/`?`automagical-board-feed:${e.data?.board_id}`:"",AggregatedActivityFeedResource:e=>`trieditfeed:${e.aggregated_pin_data_id}`,AggregatedCommentFeedResource:e=>`aggregated-comments:${e.objectId}`,AggregatedCommentReplyFeedResource:e=>`${d.Z.AGGREGATED_COMMENT_REPLIES}:${e.objectId}`,BoardlessPinsResource:e=>`boardless-pins:${e.userId}`,BestPinsFeedAltResource:e=>`idea-page-best-pins:${e.interest}`,BoardArchiveResource:()=>"archived-boards",BoardContentRecommendationResource:e=>`recommendation-feed:${e.id}`,BoardFeedResource:e=>`boardfeed:${e.board_id}`,BoardSectionsRepinResource:e=>`board-sections:${e.board_id}`,BoardSectionsResource:e=>`board-sections:${e.board_id}`,BoardSectionPinsResource:e=>`board-section-pins:${e.section_id}`,BoardsFeedResource:e=>`profile-boards:${e.username}`,BoardToolsFeedResource:e=>`board-tools:${e.boardId}`,ConversationsResource:()=>"conversations",DidItLikedByResource:e=>`triedit-likes:${e.didItDataId}`,DidItUserFeedResource:e=>`profile-tried:${e.username}`,InterestResource:e=>`klp-pins:${e.interest}`,MoreIdeasTabsBoardsResource:()=>"homefeed-more-ideas-tabs",NewsHubResource:()=>"notifications",NewsHubDetailsResource:e=>`newshubdetail:${e.news_id}`,NuxInterestsResource:()=>"nuxTopics",PinsFromBrandResource:e=>`brand-pins:${e.pin}`,ReactionsResource:e=>`reactions:${e.pin_id}`,RelatedArticlesResource:e=>`related-articles:${e.article_id}`,RelatedModulesResource:e=>`related-modules:${e.pin_id}`,RelatedPinFeedResource:e=>`related-pins:${e.pin}`,RelatedStreamResource:e=>`related-story-pins:${e.pinId}`,SearchResource:e=>`search:${(0,l.Tb)(e)}`,BaseSearchResource:e=>`search:${(0,l.Tb)(e)}`,SectionToolsFeedResource:e=>`section-tools:${e.sectionId}`,ShareSuggestionsTypeaheadResource:e=>`share-suggestions:${e.board||e.user}:${e.term}`,StoryFeedResource:e=>`story-feed:${e.feed_type}:${e.request_params}`,StoryPinTaggedProductsResource:()=>"story-pin-tagged-products",TodayArticleFeedResource:e=>`today-article:${e.id}`,TodayTabInterestFeedResource:e=>`today-article-interestfeed:${e.interest_id}`,TodayTabResource:()=>"today-tab",SeoTier1CandidateResource:()=>"tier1-feed",UnifiedCommentsResource:e=>`unified-comments:${e.aggregated_pin_id}`,UserActivityPinsResource:e=>`profile-pins-feed:${e.user_id}`,UserHomefeedResource:e=>e.pin_quiz?"pin-quiz":"homefeed",UserFollowingResource:e=>`user-following:${e.username}`,UserRecentActivityResource:e=>`user-recent-activity:${e.filter_type}`,UserStoryPinsFeedResource:e=>`story-pins-feed:${e.user_id}`,VisualLiveSearchResource:e=>`visual-search:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualLiveSearchProductFeedResource:e=>`visual-search-products:${e.pin_id}:${e.crop.x}${e.crop.y}${e.crop.w}${e.crop.h}`,VisualSearchFlashlightUnifiedResource:e=>`related-products-unified:${e.pin_id}`,InterestFollowingResource:e=>`topic-following:${e.username}`,UserPinsResource:e=>`profile-pins:${e.username}`,TopicFeedResource:e=>e.best_pins?`best-topic-pins:${e.interest}`:`topic-pins:${e.interest}`},p={AggregatedActivityFeedResource:({options:{aggregated_pin_data_id:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),AggregatedCommentFeedResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e}),AggregatedCommentReplyFeedResource:({options:{isUnifiedComment:e,objectId:a}})=>({type:e?d.Z.AGGREGATED_COMMENT_REPLIES:d.Z.AGGREGATED_COMMENTS,id:a,reversed:!0}),ApiResource:({options:{url:e,data:a}})=>e===`/v3/usecases/${a?.use_case_id}/feed/`?{type:d.Z.USE_CASE_TAB,id:a.use_case_id}:e===`/v3/boards/${a?.board_id}/automagical/pins/`?{type:d.Z.AUTOMAGICAL_BOARD_FEED,id:a.board_id}:null,BoardFeedResource:({options:{board_id:e}})=>({type:d.Z.BOARDFEED,id:e}),BoardlessPinsResource:({options:{userId:e}})=>({type:d.Z.BOARDLESS_PINS,id:e}),BoardSectionPinsResource:({options:{section_id:e}})=>({type:d.Z.BOARD_SECTION_PINS,id:e}),BoardSectionsResource:({options:{board_id:e}})=>({type:d.Z.BOARD_SECTIONS,id:e}),BoardsResource:({options:{username:e,sort:a,filter_types:t}})=>({type:d.Z.PROFILE_BOARDS,id:(0,r.Z)(e,a,t)}),BaseSearchResource:({options:e,response:a})=>({type:d.Z.SEARCH_PINS,id:(0,l.Tb)(e),items:a.resource_response.data?.results||[]}),DidItCommentsResource:({options:{objectId:e}})=>({type:d.Z.AGGREGATED_COMMENTS,id:e,reversed:!0}),DidItUserFeedResource:({options:{username:e}})=>({type:d.Z.TRIED_IT_FEED,id:e}),RelatedArticlesResource:({options:{article_id:e}})=>({type:d.Z.TODAY_TAB,id:e}),StoryPinDraftsResource:({options:{userId:e}})=>({type:d.Z.STORY_PIN_DATA,id:e}),TodayTabInterestFeedResource:({options:{interest_id:e}})=>({type:d.Z.TODAY_ARTICLE_INTEREST_FEED,id:e}),TodayTabResource:()=>({type:d.Z.TODAY_TAB,id:"todayTab"}),UnifiedCommentsPreviewResource:({options:{aggregated_pin_id:e}})=>({type:d.Z.UNIFIED_COMMENTS,id:e}),UnifiedCommentsResource:({options:{aggregated_pin_id:e,is_reversed:a}})=>({type:d.Z.UNIFIED_COMMENTS,id:e,reversed:a}),UserActivityPinsResource:({options:{user_id:e}})=>({type:d.Z.PROFILE_PINS_FEED,id:e}),UserStoryPinsFeedResource:({response:e,options:{user_id:a}})=>({type:d.Z.STORY_PINS_FEED,id:a,items:e.resource_response.data||[]})},g=(e,{pinId:a,oldFeedId:t,newFeedId:n})=>t===n?e:((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:[{type:"pin",id:a},...e[t]]}:e)(((e,{pinId:a,feedId:t})=>e[t]?{...e,[t]:e[t].filter(e=>"pin"!==e.type||e.id!==a)}:e)(e,{pinId:a,feedId:t}),{pinId:a,feedId:n}),m=(e,a)=>e in c?c[e](a):null,h=(e,a)=>a?`board-section-pins:${a}`:`boardfeed:${e}`,y=(e,a)=>e.map(e=>{let{id:t,schema:n,type:i}=e;return"home_feed_tabs"===i?e:n?{id:t,type:n,trackingParams:"pin"===n?a.pins[t].tracking_params:void 0,user_id:void 0}:null}).filter(Boolean),f=(e,a,t)=>Object.keys(e).reduce((n,i)=>{let l=e[i]||[],r=l.filter(e=>{if(e.type!==a)return!0;if("reaction"===a){let a=e.id.lastIndexOf(":");return e.id.substring(0,a)!==t}return e.id!==t});return l.length!==r.length&&(n[i]=r),n},{...e}),_=(e={},a)=>{switch(a.type){case i.zP:case i.aW:{let{payload:t}=a,{resource:n,options:l,normalizedResponse:r,schema:u}=t;if(r&&n in c){let t=((e,a,t)=>{let n=t||s.Z[e];if(n===o.LR)return a.result;if(n===o.sN)return a.result.map(e=>({id:e,schema:"board"}));if(n===o.Gn)return a.result.map(e=>({id:e,schema:"user"}));if(n===o.Ht)return a.result.map(e=>({id:e,schema:"invite"}));if(n===o.fE)return a.result.map(e=>({id:e,schema:"reaction"}));if("object"==typeof n){let e=Object.entries(n).find(([,e])=>e===o.LR);if(e)return a.result[e[0]]}return null})(n,r,u);if(t&&Array.isArray(t)){let s=c[n](l);if("BoardToolsFeedResource"===n||"SectionToolsFeedResource"===n)return{...e,[s]:t};if("UnifiedCommentsResource"===n){let n=y(t,r.entities);if(e[s]&&(i.zP||i.aW===a.type))return{...e,[s]:[...e[s],...n]};return{...e,[s]:n}}{let n=[...a.type===i.aW&&e[s]||[],...y(t,r.entities)];return{...e,[s]:n}}}}else{let{data:n}=t.response.resource_response;if(!t.options?.redux_normalize_feed)return e;let l=p[t.resource]({options:t.options,response:t.response});if(l){let{type:t,id:r,items:s,reversed:o}=l,u=(s||n||[]).filter(Boolean).map(e=>((e,a)=>{switch(e.type){case"story":return{id:e.id??"",type:"story",story_type:e.story_type??""};case"module":return{id:e.id,type:"module",name:e.name};case"user":return{id:e.id,type:"user"};case"board":return a===d.Z.PROFILE_BOARDS?{id:e.id,type:"board",onProfile:!0,profileGroup:e.archived_by_me_at?"archived":e.privacy||"public"}:{id:e.id,type:"board",onProfile:!1};case"board_section":return{type:"boardsection",id:e.id};case"triedit":return{type:"triedit",id:e.id};case"aggregatedcomment":return{type:"aggregatedcomment",id:e.id};case"home_feed_tab":return{type:"home_feed_tab",id:e.id,name:e.name};case"storypindata":return{id:e.id,type:"storypindata"};case"todayarticle":return{type:"todayarticle",id:e.id};case"unifiedcommentspreview":return"userdiditdata"===e.unified_comment.type?{type:"triedit",id:e.unified_comment.id}:{type:"aggregatedcomment",id:e.unified_comment.id};default:let t="useCaseFeed"===a&&"tracking_params"in e;return{type:"pin",id:e.id??"",...t&&{trackingParams:e.tracking_params}}}})(e,t));o&&(u=u.reverse());let c=`${t}:${r}`,p=e[c];if(p||a.type!==i.aW){let t=p||[],n=u;return a.type===i.aW&&(n=o?u.concat(t):t.concat(u)),{...e,[c]:n}}}}break}case"FEED_ITEM_REORDERED":{let{payload:{feedType:t,feedId:i,itemType:l,targetItemId:r,sourceItemId:s}}=a,o=`${t}:${i}`,u=e[o]||[],c=-1,p=-1;if([d.Z.BOARDFEED,d.Z.BOARD_SECTION_PINS,d.Z.BOARD_SECTIONS,"profileBoards"].includes(t)&&(c=u.findIndex(e=>e.type===l&&e.id===s),p=u.findIndex(e=>e.type===l&&e.id===r)),-1!==c&&-1!==p)return{...e,[o]:(0,n.Z)(u,c,p)};break}case"FEED_ITEMS_REMOVED":{let{payload:{feedType:t,feedId:n,inverseSelection:i,itemType:l,itemIds:r=[]}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&o.length>0&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===l&&(i&&!a||!i&&a))}),t=!!a.find(e=>"pin"===e.type);return{...e,[s]:t?a:[]}}if(o&&o.length>0&&t===d.Z.BOARD_SECTIONS||o&&o.length>0&&(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.BOARDLESS_PINS||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS||t===d.Z.TRIED_IT_FEED||t===d.Z.STORY_PIN_DATA)){let a=o.filter(e=>{let a=r.includes(e.id);return!(e.type===l&&a)});return{...e,[s]:a}}break}case"FEED_ITEMS_ADDED":{let{payload:{feedType:t,feedId:n,itemType:i,itemIds:l=[],prepend:r}}=a,s=`${t}:${n}`,o=e[s]||[];if(o&&(t===d.Z.BOARD_SECTION_PINS||t===d.Z.BOARDFEED||t===d.Z.BOARDLESS_PINS)){let a=l.map(e=>({id:e,type:i})),t=0;"story"===(o[0]||{}).type&&(t=1),"story"===(o[1]||{}).type&&(t=2);let n=[...o.slice(0,t),...a,...o.slice(t)];return{...e,[s]:n}}if(o&&t===d.Z.BOARD_SECTIONS){let a=[...l].reverse().map(e=>({id:e,type:"boardsection"})),t=o?[...a,...o]:[...a];return{...e,[s]:t}}if(t===d.Z.AGGREGATED_COMMENTS||t===d.Z.AGGREGATED_COMMENT_REPLIES||t===d.Z.PROFILE_PINS_FEED||t===d.Z.STORY_PINS_FEED||t===d.Z.UNIFIED_COMMENTS){let a=l.map(e=>({id:e,type:i})),t=o?[...r?a:o,...r?o:a]:a;return{...e,[s]:t}}if(t===d.Z.TRIED_IT_FEED){let a=l.map(e=>({id:e,type:i})),t=o?[...a,...o]:a;return{...e,[s]:t}}break}case"FEED_INVALIDATE":{let{payload:{feedType:t,feedId:n}}=a,i=`${t}:${n}`;return e[i],{...e,[i]:null}}case"APPEND_FEED_ITEMS":{let{payload:{id:t,items:n,options:i}}=a,l=e[t];if(!l)return{...e,[t]:n};{let a;return a=i.isPrepend?l[0]&&"story"===l[0].type?[].concat(l[0],n,l.slice(1)):n.concat(l):l.concat(n),{...e,[t]:a}}}case"PIN_DELETE":{let{payload:{pinId:t}}=a;return f(e,"pin",t)}case"BOARD_ARCHIVE":{let{payload:{boardId:t,username:n}}=a,i=`profile-boards:${n??""}`;if(e[i])return{...e,[i]:e[i].filter(e=>e.id!==t)};break}case"BOARD_UNARCHIVE":{let{payload:{boardId:t}}=a,n="archived-boards";if(e[n])return{...e,[n]:e[n].filter(e=>e.id!==t)};break}case"BOARD_DELETE":{let{payload:{boardId:t}}=a;return f(e,"board",t)}case"BOARD_SECTION_DELETE":{let{payload:{boardSectionId:t}}=a;return f(e,"boardsection",t)}case"PINS_MOVE":{let{payload:{source:t,target:n,pinIds:i,userId:l}}=a,r=t.boardlessPins&&l&&`boardless-pins:${l}`||t.boardId&&h(t.boardId,t.sectionId),s=h(n.boardId,n.sectionId);return i.reduce((e,a)=>g(e,{pinId:a,oldFeedId:r,newFeedId:s}),e)}case"PINS_MOVE_ALL":{let{payload:{source:t,target:n,excludePinIds:i}}=a,l=h(t.boardId,t.sectionId),r=h(n.boardId,n.sectionId),s={...e,[l]:i.map(e=>({type:"pin",id:e}))};return delete s[r],s}case"PIN_EDIT":{let{payload:{pinId:t,boardId:n,sectionId:i="",source:{boardId:l,sectionId:r}}}=a;return g(e,{pinId:t,oldFeedId:h(l,r),newFeedId:h(n,i)})}case i.AF:if(u.has(a.payload.resource)){let t,n=a.payload.response.resource_response.data,{board:i}=n;if("quick_saves"===i.layout)t=`boardless-pins:${a.payload.options.user_id}`;else{let e=a.payload.options.section;t=e?`board-section-pins:${e}`:`boardfeed:${i.id}`}if(e[t]){let a={...e},i={id:n.id,type:"pin",trackingParams:n?.tracking_params};return a[t]=[i].concat(e[t]),a}}if("BoardSectionResource"===a.payload.resource&&a.payload.normalizedResponse){let t=a.payload.normalizedResponse.result,n=a.payload.normalizedResponse.entities.boardsections[t].board,i=`board-sections:${n}`;if(e[i]){let a={...e};return a[i]=[{id:t,type:"boardsection"}].concat(e[i]),a}}if("AggregatedCommentResource"===a.payload.resource&&a.payload.normalizedResponse){let t={id:a.payload.normalizedResponse.result,type:"aggregatedcomment"},n={...e};for(let i of["aggregated-comments","unified-comments"]){let l=`${i}:${a.payload.options.objectId}`;e[l]&&(n={...n,[l]:[t].concat(n[l])})}return n}if("AggregatedCommentReplyResource"===a.payload.resource&&a.payload.normalizedResponse){let t=`${d.Z.AGGREGATED_COMMENT_REPLIES}:${a.payload.options.objectId}`;return{...e,[t]:[...e[t]||[],{id:a.payload.normalizedResponse.result,type:"aggregatedComment"}]}}if("ReactionsResource"===a.payload.resource&&a.payload.normalizedResponse){let{reaction_pin_id:t,reaction_type:n}=a.payload.options;if("reaction"===a.payload.options.action_type){let i=`reactions:${a.payload.options.pin_id}`,l={...e},r={id:`${t}:${a.payload.options.user_id}:${n}`,type:"reaction",trackingParams:void 0};return l[i]=[r].concat(e[i]),l}if("unreaction"===a.payload.options.action_type)return f(e,"reaction",`${t}:${a.payload.options.user_id}`)}break;case"COMPLETE_STORY":{let{payload:{storyId:t}}=a;return f(e,"story",t)}}return e}},588836:function(e,a,t){t.d(a,{Z:()=>x});var n=t(281098),i=t(667294),l=t(581722),r=t(825332),s=t(20256),o=t(111330),d=t(521009),u=t(346955),c=t(667835),p=t(19585),g=t(506662),m=t(753143),h=t(941404),y=t(572227),f=t(647709),_=t(785893);function x({alignIconLeft:e,bgColor:a,color:t,disableRedirect:x=!1,fallbackUrl:v,icon:S="arrow-back",onTouch:w,padding:k,placement:b,shouldUseFallbackUrl:P,size:F="lg",viewParameter:C,viewType:R,isVisualSearch:I}){(0,i.useEffect)(()=>{(0,n.Z)("BackButton","/app/www/routing/BackButton.tsx")},[]);let T=(0,p.ZP)(),j=(0,r.s0)(),E=(0,r.TH)(),Z=(0,f.HG)(),D=(0,l.v9)(e=>e.session.isAuthenticated),M=(0,d.Z)(),K=(0,y.Z)(),L=(0,c.vs)(),{viewType:A,viewParameter:$}=(0,u.SU)(),[O,B]=R?[R,C]:[A,$],N=()=>{let e=(0,m.M0)().getItem(o.pm);E.key||"/ideas"!==v?(0,h.My)(`pinner_conversion.back_button.${String(e?.[0].pageType)}`):(0,h.My)("pinner_conversion.back_button.no_history"),(0,h.My)(`web_back_button_click.${String(b)}.is_auth_${String(D)}`),K({action:"click",item:"back-button"}),O&&M({view_type:O,view_parameter:B,element:34,event_type:102}),w&&w(),x||((!E.key||E.state&&"redirect"===E.state.referrer||P)&&v?j(v):E.pathname.includes("/password/reset/")&&E.search&&E.search.includes("?nativeShouldDismiss=true")?j("/login/?dismissWebview=true"):j(-1))},z=L?c.t4:"white",U=(0,g.am)(E)||I||"white"===t;return(0,_.jsx)(s.xu,{"data-test-id":"back-button",children:e?(0,_.jsx)(s.xu,{alignItems:"center",display:"flex",height:48,marginStart:"cancel"===S?-1:-2,width:48,children:(0,_.jsx)(s.hU,{accessibilityLabel:T._('Back', 'navigation button', 'navigation button'),bgColor:a,icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==k?k:2,size:F})}):(0,_.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:Z||U||a?"":z,width:L&&!U?"fit-content":""}},rounding:"circle",children:(0,_.jsx)(s.hU,{accessibilityLabel:T._('Back', 'navigation button', 'navigation button'),bgColor:a||Z?a:"transparent",icon:S,iconColor:!t&&(!a||["white","lightGray","transparent"].includes(a))?"gray":t,onClick:N,padding:"auto"!==k?k:2,size:F})})})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/45514-fc80c5e8d3ddff57.mjs.map